

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>tlo.methods.newborn_outcomes &mdash; TLOmodel 0.1.0 documentation</title>
  

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/theme_overrides.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../../../_static/favicon.png"/>
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html" class="icon icon-home"> TLOmodel
          

          
          </a>

          
            
            
              <div class="version">
                0.1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../index.html">Welcome</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../aims.html">Aims &amp; Objectives</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../writeups.html">Model Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../data_sources.html">Data Sources</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../readme.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../azure_batch.html">Using Azure Batch</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../reference/index.html">Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../publications.html">Publications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../authors.html">Authors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../contributing.html">Contributing</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">TLOmodel</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../../index.html">Module code</a> &raquo;</li>
        
          <li><a href="../methods.html">tlo.methods</a> &raquo;</li>
        
      <li>tlo.methods.newborn_outcomes</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for tlo.methods.newborn_outcomes</h1><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="kn">from</span> <span class="nn">tlo</span> <span class="kn">import</span> <span class="n">DateOffset</span><span class="p">,</span> <span class="n">Module</span><span class="p">,</span> <span class="n">Parameter</span><span class="p">,</span> <span class="n">Property</span><span class="p">,</span> <span class="n">Types</span><span class="p">,</span> <span class="n">logging</span>
<span class="kn">from</span> <span class="nn">tlo.events</span> <span class="kn">import</span> <span class="n">Event</span><span class="p">,</span> <span class="n">IndividualScopeEventMixin</span>
<span class="kn">from</span> <span class="nn">tlo.lm</span> <span class="kn">import</span> <span class="n">LinearModel</span>
<span class="kn">from</span> <span class="nn">tlo.methods</span> <span class="kn">import</span> <span class="n">Metadata</span><span class="p">,</span> <span class="n">demography</span><span class="p">,</span> <span class="n">newborn_outcomes_lm</span><span class="p">,</span> <span class="n">pregnancy_helper_functions</span>
<span class="kn">from</span> <span class="nn">tlo.methods.causes</span> <span class="kn">import</span> <span class="n">Cause</span>
<span class="kn">from</span> <span class="nn">tlo.methods.healthsystem</span> <span class="kn">import</span> <span class="n">HSI_Event</span>
<span class="kn">from</span> <span class="nn">tlo.methods.hiv</span> <span class="kn">import</span> <span class="n">HSI_Hiv_TestAndRefer</span>
<span class="kn">from</span> <span class="nn">tlo.methods.postnatal_supervisor</span> <span class="kn">import</span> <span class="n">PostnatalWeekOneNeonatalEvent</span>
<span class="kn">from</span> <span class="nn">tlo.util</span> <span class="kn">import</span> <span class="n">BitsetHandler</span>

<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
<span class="n">logger</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>


<div class="viewcode-block" id="NewbornOutcomes"><a class="viewcode-back" href="../../../reference/tlo.methods.newborn_outcomes.html#tlo.methods.newborn_outcomes.NewbornOutcomes">[docs]</a><span class="k">class</span> <span class="nc">NewbornOutcomes</span><span class="p">(</span><span class="n">Module</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This module is responsible for simulating the key conditions/complications experienced by a neonate immediately</span>
<span class="sd">    following birth (either at home or in a health facility). Important predictors of newborn health also generated by</span>
<span class="sd">    this model include low birth weight and small for gestational age. Complications modelled include early-onset</span>
<span class="sd">    neonatal sepsis, neonatal encephalopathy, congenital birth anomalies, failure to breathe at birth and complications</span>
<span class="sd">    of prematurity (respiratory distress syndrome and retinopathy) This module also manages any interventions that are</span>
<span class="sd">    delivered by skilled birth  attendants to newborns following a facility delivery via</span>
<span class="sd">    HSI_NewbornOutcomes_CareOfTheNewbornBySkilledAttendantAtBirth and interventions delivered as part of postnatal care</span>
<span class="sd">    via HSI_NewbornOutcomes_ReceivesPostnatalCheck.</span>
<span class="sd">    &quot;&quot;&quot;</span>
<div class="viewcode-block" id="NewbornOutcomes.__init__"><a class="viewcode-back" href="../../../reference/tlo.methods.newborn_outcomes.html#tlo.methods.newborn_outcomes.NewbornOutcomes.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">resourcefilepath</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">resourcefilepath</span> <span class="o">=</span> <span class="n">resourcefilepath</span>

        <span class="c1"># First we define dictionaries which will store the current parameters of interest (to allow parameters to</span>
        <span class="c1"># change between 2010 and 2020) and the linear models</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_parameters</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nb_linear_models</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

        <span class="c1"># This dictionary will store information related to the neonates delivery that does not need to be stored in</span>
        <span class="c1"># the main data frame</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">newborn_care_info</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

        <span class="c1"># and then define a dictionary which will hold the required consumables for each intervention</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">item_codes_nb_consumables</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span></div>

    <span class="n">INIT_DEPENDENCIES</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Demography&#39;</span><span class="p">,</span> <span class="s1">&#39;HealthSystem&#39;</span><span class="p">}</span>

    <span class="n">OPTIONAL_INIT_DEPENDENCIES</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;HealthBurden&#39;</span><span class="p">}</span>

    <span class="n">ADDITIONAL_DEPENDENCIES</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;CareOfWomenDuringPregnancy&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Labour&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PostnatalSupervisor&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PregnancySupervisor&#39;</span>
    <span class="p">}</span>

    <span class="n">METADATA</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">Metadata</span><span class="o">.</span><span class="n">DISEASE_MODULE</span><span class="p">,</span>
        <span class="n">Metadata</span><span class="o">.</span><span class="n">USES_HEALTHSYSTEM</span><span class="p">,</span>
        <span class="n">Metadata</span><span class="o">.</span><span class="n">USES_HEALTHBURDEN</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="c1"># Declare Causes of Death</span>
    <span class="n">CAUSES_OF_DEATH</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;early_onset_sepsis&#39;</span><span class="p">:</span> <span class="n">Cause</span><span class="p">(</span><span class="n">gbd_causes</span><span class="o">=</span><span class="s1">&#39;Neonatal disorders&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Neonatal Disorders&#39;</span><span class="p">),</span>
        <span class="s1">&#39;late_onset_sepsis&#39;</span><span class="p">:</span> <span class="n">Cause</span><span class="p">(</span><span class="n">gbd_causes</span><span class="o">=</span><span class="s1">&#39;Neonatal disorders&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Neonatal Disorders&#39;</span><span class="p">),</span>
        <span class="s1">&#39;encephalopathy&#39;</span><span class="p">:</span> <span class="n">Cause</span><span class="p">(</span><span class="n">gbd_causes</span><span class="o">=</span><span class="s1">&#39;Neonatal disorders&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Neonatal Disorders&#39;</span><span class="p">),</span>
        <span class="s1">&#39;neonatal_respiratory_depression&#39;</span><span class="p">:</span> <span class="n">Cause</span><span class="p">(</span><span class="n">gbd_causes</span><span class="o">=</span><span class="s1">&#39;Neonatal disorders&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Neonatal Disorders&#39;</span><span class="p">),</span>
        <span class="s1">&#39;preterm_other&#39;</span><span class="p">:</span> <span class="n">Cause</span><span class="p">(</span><span class="n">gbd_causes</span><span class="o">=</span><span class="s1">&#39;Neonatal disorders&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Neonatal Disorders&#39;</span><span class="p">),</span>
        <span class="s1">&#39;respiratory_distress_syndrome&#39;</span><span class="p">:</span> <span class="n">Cause</span><span class="p">(</span><span class="n">gbd_causes</span><span class="o">=</span><span class="s1">&#39;Neonatal disorders&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Neonatal Disorders&#39;</span><span class="p">),</span>
        <span class="s1">&#39;congenital_heart_anomaly&#39;</span><span class="p">:</span> <span class="n">Cause</span><span class="p">(</span><span class="n">gbd_causes</span><span class="o">=</span><span class="s1">&#39;Neonatal disorders&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Neonatal Disorders&#39;</span><span class="p">),</span>
        <span class="s1">&#39;limb_or_musculoskeletal_anomaly&#39;</span><span class="p">:</span> <span class="n">Cause</span><span class="p">(</span><span class="n">gbd_causes</span><span class="o">=</span><span class="s1">&#39;Neonatal disorders&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Neonatal Disorders&#39;</span><span class="p">),</span>
        <span class="s1">&#39;urogenital_anomaly&#39;</span><span class="p">:</span> <span class="n">Cause</span><span class="p">(</span><span class="n">gbd_causes</span><span class="o">=</span><span class="s1">&#39;Neonatal disorders&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Neonatal Disorders&#39;</span><span class="p">),</span>
        <span class="s1">&#39;digestive_anomaly&#39;</span><span class="p">:</span> <span class="n">Cause</span><span class="p">(</span><span class="n">gbd_causes</span><span class="o">=</span><span class="s1">&#39;Neonatal disorders&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Neonatal Disorders&#39;</span><span class="p">),</span>
        <span class="s1">&#39;other_anomaly&#39;</span><span class="p">:</span> <span class="n">Cause</span><span class="p">(</span><span class="n">gbd_causes</span><span class="o">=</span><span class="s1">&#39;Neonatal disorders&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Neonatal Disorders&#39;</span><span class="p">),</span>

    <span class="p">}</span>

    <span class="c1"># Declare Causes of Disability</span>
    <span class="n">CAUSES_OF_DISABILITY</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;Retinopathy of Prematurity&#39;</span><span class="p">:</span>
            <span class="n">Cause</span><span class="p">(</span><span class="n">gbd_causes</span><span class="o">=</span><span class="s1">&#39;Neonatal disorders&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Neonatal Disorders&#39;</span><span class="p">),</span>
        <span class="s1">&#39;Neonatal Encephalopathy&#39;</span><span class="p">:</span>
            <span class="n">Cause</span><span class="p">(</span><span class="n">gbd_causes</span><span class="o">=</span><span class="s1">&#39;Neonatal disorders&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Neonatal Disorders&#39;</span><span class="p">),</span>
        <span class="s1">&#39;Neonatal Sepsis Long term Disability&#39;</span><span class="p">:</span>
            <span class="n">Cause</span><span class="p">(</span><span class="n">gbd_causes</span><span class="o">=</span><span class="s1">&#39;Neonatal disorders&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Neonatal Disorders&#39;</span><span class="p">),</span>
        <span class="s1">&#39;Preterm Birth Disability&#39;</span><span class="p">:</span>
            <span class="n">Cause</span><span class="p">(</span><span class="n">gbd_causes</span><span class="o">=</span><span class="s1">&#39;Neonatal disorders&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Neonatal Disorders&#39;</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="n">PARAMETERS</span> <span class="o">=</span> <span class="p">{</span>
        <span class="c1"># n.b. Parameters are stored as LIST variables due to containing values to match both 2010 and 2015 data.</span>

        <span class="c1"># CARE SEEKING</span>
        <span class="s1">&#39;prob_care_seeking_for_complication&#39;</span><span class="p">:</span> <span class="n">Parameter</span><span class="p">(</span>
            <span class="n">Types</span><span class="o">.</span><span class="n">LIST</span><span class="p">,</span> <span class="s1">&#39;baseline probability that a mother will seek care for an unwell neonate following delivery&#39;</span><span class="p">),</span>
        <span class="s1">&#39;prob_day_reaches_week_one_event&#39;</span><span class="p">:</span> <span class="n">Parameter</span><span class="p">(</span>
            <span class="n">Types</span><span class="o">.</span><span class="n">LIST</span><span class="p">,</span> <span class="s1">&#39;Probabilities for day of attendance at postnatal week one event&#39;</span><span class="p">),</span>

        <span class="c1"># EARLY ONSET SEPSIS...</span>
        <span class="s1">&#39;prob_early_onset_neonatal_sepsis_day_0&#39;</span><span class="p">:</span> <span class="n">Parameter</span><span class="p">(</span>
            <span class="n">Types</span><span class="o">.</span><span class="n">LIST</span><span class="p">,</span> <span class="s1">&#39;baseline probability of a neonate developing early onset sepsis between birth and 24hrs&#39;</span><span class="p">),</span>
        <span class="s1">&#39;rr_eons_maternal_chorio&#39;</span><span class="p">:</span> <span class="n">Parameter</span><span class="p">(</span>
            <span class="n">Types</span><span class="o">.</span><span class="n">LIST</span><span class="p">,</span> <span class="s1">&#39;relative risk of EONS in newborns whose mothers have chorioamnionitis&#39;</span><span class="p">),</span>
        <span class="s1">&#39;rr_eons_maternal_prom&#39;</span><span class="p">:</span> <span class="n">Parameter</span><span class="p">(</span>
            <span class="n">Types</span><span class="o">.</span><span class="n">LIST</span><span class="p">,</span> <span class="s1">&#39;relative risk of EONS in newborns whose mothers have PROM&#39;</span><span class="p">),</span>
        <span class="s1">&#39;rr_eons_preterm_neonate&#39;</span><span class="p">:</span> <span class="n">Parameter</span><span class="p">(</span>
            <span class="n">Types</span><span class="o">.</span><span class="n">LIST</span><span class="p">,</span> <span class="s1">&#39;relative risk of EONS in preterm newborns&#39;</span><span class="p">),</span>
        <span class="s1">&#39;cfr_early_onset_sepsis&#39;</span><span class="p">:</span> <span class="n">Parameter</span><span class="p">(</span>
            <span class="n">Types</span><span class="o">.</span><span class="n">LIST</span><span class="p">,</span> <span class="s1">&#39;case fatality rate for a neonate due to neonatal sepsis&#39;</span><span class="p">),</span>
        <span class="s1">&#39;cfr_late_onset_sepsis&#39;</span><span class="p">:</span> <span class="n">Parameter</span><span class="p">(</span>
            <span class="n">Types</span><span class="o">.</span><span class="n">LIST</span><span class="p">,</span> <span class="s1">&#39;case fatality rate for a neonate due to neonatal sepsis&#39;</span><span class="p">),</span>

        <span class="c1"># NOT BREATHING AT BIRTH....</span>
        <span class="s1">&#39;prob_failure_to_transition&#39;</span><span class="p">:</span> <span class="n">Parameter</span><span class="p">(</span>
            <span class="n">Types</span><span class="o">.</span><span class="n">LIST</span><span class="p">,</span> <span class="s1">&#39;baseline probability of a neonate developing intrapartum related complications &#39;</span>
                        <span class="s1">&#39;(previously birth asphyxia) following delivery &#39;</span><span class="p">),</span>
        <span class="s1">&#39;prob_enceph_no_resus&#39;</span><span class="p">:</span> <span class="n">Parameter</span><span class="p">(</span>
            <span class="n">Types</span><span class="o">.</span><span class="n">LIST</span><span class="p">,</span> <span class="s1">&#39;Probability of a newborn who was not breathing at birth, and didnt receive resuscitation, &#39;</span>
                        <span class="s1">&#39;developing encephalopathy &#39;</span><span class="p">),</span>
        <span class="s1">&#39;cfr_failed_to_transition&#39;</span><span class="p">:</span> <span class="n">Parameter</span><span class="p">(</span>
            <span class="n">Types</span><span class="o">.</span><span class="n">LIST</span><span class="p">,</span> <span class="s1">&#39;case fatality rate for a neonate following failure to transition&#39;</span><span class="p">),</span>

        <span class="c1"># ENCEPHALOPATHY AND RESPIRATORY DEPRESSION...</span>
        <span class="s1">&#39;prob_encephalopathy&#39;</span><span class="p">:</span> <span class="n">Parameter</span><span class="p">(</span>
            <span class="n">Types</span><span class="o">.</span><span class="n">LIST</span><span class="p">,</span> <span class="s1">&#39;baseline odds of a neonate developing encephalopathy of any severity following birth&#39;</span><span class="p">),</span>
        <span class="s1">&#39;rr_enceph_neonatal_sepsis&#39;</span><span class="p">:</span> <span class="n">Parameter</span><span class="p">(</span>
            <span class="n">Types</span><span class="o">.</span><span class="n">LIST</span><span class="p">,</span> <span class="s1">&#39;relative risk of neonatal encephalopathy if the neonate is also septic&#39;</span><span class="p">),</span>
        <span class="s1">&#39;rr_enceph_obstructed_labour&#39;</span><span class="p">:</span> <span class="n">Parameter</span><span class="p">(</span>
            <span class="n">Types</span><span class="o">.</span><span class="n">LIST</span><span class="p">,</span> <span class="s1">&#39;relative risk  for encephalopathy if the mothers labour was obstructed&#39;</span><span class="p">),</span>
        <span class="s1">&#39;rr_enceph_acute_hypoxic_event&#39;</span><span class="p">:</span> <span class="n">Parameter</span><span class="p">(</span>
            <span class="n">Types</span><span class="o">.</span><span class="n">LIST</span><span class="p">,</span> <span class="s1">&#39;relative risk for encephalopathy if the mothers experience an acute event in labour&#39;</span><span class="p">),</span>
        <span class="s1">&#39;prob_enceph_severity&#39;</span><span class="p">:</span> <span class="n">Parameter</span><span class="p">(</span>
            <span class="n">Types</span><span class="o">.</span><span class="n">LIST</span><span class="p">,</span> <span class="s1">&#39;probability of the severity of encephalopathy in a newborn who is encephalopathic&#39;</span><span class="p">),</span>
        <span class="s1">&#39;prob_mild_impairment_post_enceph&#39;</span><span class="p">:</span> <span class="n">Parameter</span><span class="p">(</span>
            <span class="n">Types</span><span class="o">.</span><span class="n">LIST</span><span class="p">,</span> <span class="s1">&#39;probability of the mild neurodevelopmental impairment in survivors of encephalopathy&#39;</span><span class="p">),</span>
        <span class="s1">&#39;prob_mod_severe_impairment_post_enceph&#39;</span><span class="p">:</span> <span class="n">Parameter</span><span class="p">(</span>
            <span class="n">Types</span><span class="o">.</span><span class="n">LIST</span><span class="p">,</span> <span class="s1">&#39;probability of the moderate or severe neurodevelopmental impairment in survivors of &#39;</span>
                        <span class="s1">&#39;encephalopathy&#39;</span><span class="p">),</span>
        <span class="s1">&#39;cfr_enceph&#39;</span><span class="p">:</span> <span class="n">Parameter</span><span class="p">(</span>
            <span class="n">Types</span><span class="o">.</span><span class="n">LIST</span><span class="p">,</span> <span class="s1">&#39;case fatality rate for a neonate due to mild encephalopathy&#39;</span><span class="p">),</span>
        <span class="s1">&#39;cfr_multiplier_severe_enceph&#39;</span><span class="p">:</span> <span class="n">Parameter</span><span class="p">(</span>
            <span class="n">Types</span><span class="o">.</span><span class="n">LIST</span><span class="p">,</span> <span class="s1">&#39;multiplier for risk of death in a neonate with severe encephalopathy&#39;</span><span class="p">),</span>

        <span class="c1"># COMPLICATIONS OF PREMATURITY...</span>
        <span class="s1">&#39;prob_respiratory_distress_preterm&#39;</span><span class="p">:</span> <span class="n">Parameter</span><span class="p">(</span>
            <span class="n">Types</span><span class="o">.</span><span class="n">LIST</span><span class="p">,</span> <span class="s1">&#39;probability that a preterm infant will experience respiratory distress at birth&#39;</span><span class="p">),</span>
        <span class="s1">&#39;rr_rds_maternal_diabetes_mellitus&#39;</span><span class="p">:</span> <span class="n">Parameter</span><span class="p">(</span>
            <span class="n">Types</span><span class="o">.</span><span class="n">LIST</span><span class="p">,</span> <span class="s1">&#39;relative risk of RDS in a preterm newborn whose mother has DM&#39;</span><span class="p">),</span>
        <span class="s1">&#39;rr_rds_maternal_gestational_diab&#39;</span><span class="p">:</span> <span class="n">Parameter</span><span class="p">(</span>
            <span class="n">Types</span><span class="o">.</span><span class="n">LIST</span><span class="p">,</span> <span class="s1">&#39;relative risk of RDS in a preterm newborn whose mother has gestational diabetes&#39;</span><span class="p">),</span>
        <span class="s1">&#39;cfr_respiratory_distress_syndrome&#39;</span><span class="p">:</span> <span class="n">Parameter</span><span class="p">(</span>
            <span class="n">Types</span><span class="o">.</span><span class="n">LIST</span><span class="p">,</span> <span class="s1">&#39;case fatality rate for respiratory distress syndrome of prematurity&#39;</span><span class="p">),</span>
        <span class="s1">&#39;prob_mild_disability_preterm_&lt;32weeks&#39;</span><span class="p">:</span> <span class="n">Parameter</span><span class="p">(</span>
            <span class="n">Types</span><span class="o">.</span><span class="n">LIST</span><span class="p">,</span> <span class="s1">&#39;probability of mild long term neurodevelopmental disability in preterm infants born at less &#39;</span>
                        <span class="s1">&#39;than 32 weeks gestation&#39;</span><span class="p">),</span>
        <span class="s1">&#39;prob_mod_severe_disability_preterm_&lt;32weeks&#39;</span><span class="p">:</span> <span class="n">Parameter</span><span class="p">(</span>
            <span class="n">Types</span><span class="o">.</span><span class="n">LIST</span><span class="p">,</span> <span class="s1">&#39;probability of moderate/severe longterm neurodevelopmental disability in preterm infants born &#39;</span>
                        <span class="s1">&#39;at less than 32 weeks gestation&#39;</span><span class="p">),</span>
        <span class="s1">&#39;prob_mild_disability_preterm_32_36weeks&#39;</span><span class="p">:</span> <span class="n">Parameter</span><span class="p">(</span>
            <span class="n">Types</span><span class="o">.</span><span class="n">LIST</span><span class="p">,</span> <span class="s1">&#39;probability of mild long term neurodevelopmental disability in preterm infants born between 32&#39;</span>
                        <span class="s1">&#39; and 36 weeks gestation&#39;</span><span class="p">),</span>
        <span class="s1">&#39;prob_mod_severe_disability_preterm_32_36weeks&#39;</span><span class="p">:</span> <span class="n">Parameter</span><span class="p">(</span>
            <span class="n">Types</span><span class="o">.</span><span class="n">LIST</span><span class="p">,</span> <span class="s1">&#39;probability of moderate/severe long term neurodevelopmental disability in preterm infants born&#39;</span>
                        <span class="s1">&#39; between 32 and 36 weeks gestation&#39;</span><span class="p">),</span>
        <span class="s1">&#39;prob_retinopathy_preterm&#39;</span><span class="p">:</span> <span class="n">Parameter</span><span class="p">(</span>
            <span class="n">Types</span><span class="o">.</span><span class="n">LIST</span><span class="p">,</span> <span class="s1">&#39;baseline probability of a preterm neonate developing retinopathy of prematurity &#39;</span><span class="p">),</span>
        <span class="s1">&#39;prob_retinopathy_severity&#39;</span><span class="p">:</span> <span class="n">Parameter</span><span class="p">(</span>
            <span class="n">Types</span><span class="o">.</span><span class="n">LIST</span><span class="p">,</span> <span class="s1">&#39;probabilities of severity of retinopathy&#39;</span><span class="p">),</span>
        <span class="s1">&#39;cfr_preterm_birth&#39;</span><span class="p">:</span> <span class="n">Parameter</span><span class="p">(</span>
            <span class="n">Types</span><span class="o">.</span><span class="n">LIST</span><span class="p">,</span> <span class="s1">&#39;case fatality rate for a neonate born prematurely&#39;</span><span class="p">),</span>
        <span class="s1">&#39;rr_preterm_death_early_preterm&#39;</span><span class="p">:</span> <span class="n">Parameter</span><span class="p">(</span>
            <span class="n">Types</span><span class="o">.</span><span class="n">LIST</span><span class="p">,</span> <span class="s1">&#39;relative risk of preterm death in early preterm neonates &#39;</span><span class="p">),</span>
        <span class="s1">&#39;prob_preterm_death_by_day&#39;</span><span class="p">:</span> <span class="n">Parameter</span><span class="p">(</span>
            <span class="n">Types</span><span class="o">.</span><span class="n">LIST</span><span class="p">,</span> <span class="s1">&#39;probability of death due to preterm complications occurring on days 0-14&#39;</span><span class="p">),</span>

        <span class="c1"># CONGENITAL ANOMALIES...</span>
        <span class="s1">&#39;prob_congenital_heart_anomaly&#39;</span><span class="p">:</span> <span class="n">Parameter</span><span class="p">(</span>
            <span class="n">Types</span><span class="o">.</span><span class="n">LIST</span><span class="p">,</span> <span class="s1">&#39;Probability of a congenital heart anomaly in the newborn&#39;</span><span class="p">),</span>
        <span class="s1">&#39;prob_limb_musc_skeletal_anomaly&#39;</span><span class="p">:</span> <span class="n">Parameter</span><span class="p">(</span>
            <span class="n">Types</span><span class="o">.</span><span class="n">LIST</span><span class="p">,</span> <span class="s1">&#39;Probability of a congenital limb or musculoskeletal anomaly in the newborn&#39;</span><span class="p">),</span>
        <span class="s1">&#39;prob_urogenital_anomaly&#39;</span><span class="p">:</span> <span class="n">Parameter</span><span class="p">(</span>
            <span class="n">Types</span><span class="o">.</span><span class="n">LIST</span><span class="p">,</span> <span class="s1">&#39;Probability of a congenital urogenital anomaly in the newborn&#39;</span><span class="p">),</span>
        <span class="s1">&#39;prob_digestive_anomaly&#39;</span><span class="p">:</span> <span class="n">Parameter</span><span class="p">(</span>
            <span class="n">Types</span><span class="o">.</span><span class="n">LIST</span><span class="p">,</span> <span class="s1">&#39;Probability of a congenital digestive anomaly in the newborn&#39;</span><span class="p">),</span>
        <span class="s1">&#39;prob_other_anomaly&#39;</span><span class="p">:</span> <span class="n">Parameter</span><span class="p">(</span>
            <span class="n">Types</span><span class="o">.</span><span class="n">LIST</span><span class="p">,</span> <span class="s1">&#39;Probability of a other congenital anomalies in the newborn&#39;</span><span class="p">),</span>
        <span class="s1">&#39;cfr_congenital_heart_anomaly&#39;</span><span class="p">:</span> <span class="n">Parameter</span><span class="p">(</span>
            <span class="n">Types</span><span class="o">.</span><span class="n">LIST</span><span class="p">,</span> <span class="s1">&#39;case fatality rate for newborns with congenital heart anomalies&#39;</span><span class="p">),</span>
        <span class="s1">&#39;cfr_limb_or_musculoskeletal_anomaly&#39;</span><span class="p">:</span> <span class="n">Parameter</span><span class="p">(</span>
            <span class="n">Types</span><span class="o">.</span><span class="n">LIST</span><span class="p">,</span> <span class="s1">&#39;case fatality rate for newborns with congenital limb/musculoskeletal anomalies&#39;</span><span class="p">),</span>
        <span class="s1">&#39;cfr_urogenital_anomaly&#39;</span><span class="p">:</span> <span class="n">Parameter</span><span class="p">(</span>
            <span class="n">Types</span><span class="o">.</span><span class="n">LIST</span><span class="p">,</span> <span class="s1">&#39;case fatality rate for newborns with congenital urogenital anomalies&#39;</span><span class="p">),</span>
        <span class="s1">&#39;cfr_digestive_anomaly&#39;</span><span class="p">:</span> <span class="n">Parameter</span><span class="p">(</span>
            <span class="n">Types</span><span class="o">.</span><span class="n">LIST</span><span class="p">,</span> <span class="s1">&#39;case fatality rate for newborns with congenital digestive anomalies&#39;</span><span class="p">),</span>
        <span class="s1">&#39;cfr_other_anomaly&#39;</span><span class="p">:</span> <span class="n">Parameter</span><span class="p">(</span>
            <span class="n">Types</span><span class="o">.</span><span class="n">LIST</span><span class="p">,</span> <span class="s1">&#39;case fatality rate for newborns with other congenital anomalies&#39;</span><span class="p">),</span>
        <span class="s1">&#39;prob_cba_death_by_age_group&#39;</span><span class="p">:</span> <span class="n">Parameter</span><span class="p">(</span>
            <span class="n">Types</span><span class="o">.</span><span class="n">LIST</span><span class="p">,</span> <span class="s1">&#39;probabilities that death from a congenital birth anomaly will occur once the individual &#39;</span>
                        <span class="s1">&#39;reaches the following age groups: early neonatal, late neonatal, post neonatal 1-4 years,&#39;</span>
                        <span class="s1">&#39; 5-9 years, 10 -14 years or 15-69 years&#39;</span><span class="p">),</span>

        <span class="c1"># BREASTFEEDING...</span>
        <span class="s1">&#39;prob_early_breastfeeding_hb&#39;</span><span class="p">:</span> <span class="n">Parameter</span><span class="p">(</span>
            <span class="n">Types</span><span class="o">.</span><span class="n">LIST</span><span class="p">,</span> <span class="s1">&#39;probability that a neonate will be breastfed within the first hour following birth when &#39;</span>
                        <span class="s1">&#39;delivered at home&#39;</span><span class="p">),</span>
        <span class="s1">&#39;prob_breastfeeding_type&#39;</span><span class="p">:</span> <span class="n">Parameter</span><span class="p">(</span>
            <span class="n">Types</span><span class="o">.</span><span class="n">LIST</span><span class="p">,</span> <span class="s1">&#39;probabilities that a woman is 1.) not breastfeeding 2.) non-exclusively breastfeeding &#39;</span>
                        <span class="s1">&#39;3.)exclusively breastfeeding at birth (until 6 months)&#39;</span><span class="p">),</span>
        <span class="s1">&#39;prob_early_breastfeeding_hf&#39;</span><span class="p">:</span> <span class="n">Parameter</span><span class="p">(</span>
            <span class="n">Types</span><span class="o">.</span><span class="n">LIST</span><span class="p">,</span> <span class="s1">&#39;probability that a neonate will be breastfed within the first hour following birth when &#39;</span>
                        <span class="s1">&#39;delivered at a health facility&#39;</span><span class="p">),</span>

        <span class="c1"># POSTNATAL CARE..</span>
        <span class="s1">&#39;prob_pnc_check_newborn&#39;</span><span class="p">:</span> <span class="n">Parameter</span><span class="p">(</span>
            <span class="n">Types</span><span class="o">.</span><span class="n">LIST</span><span class="p">,</span> <span class="s1">&#39;probability that a neonate will receive a full postnatal check&#39;</span><span class="p">),</span>
        <span class="s1">&#39;prob_timings_pnc_newborns&#39;</span><span class="p">:</span> <span class="n">Parameter</span><span class="p">(</span>
            <span class="n">Types</span><span class="o">.</span><span class="n">LIST</span><span class="p">,</span> <span class="s1">&#39;probabilities that a postnatal check will happen before or after 48 hours alive&#39;</span><span class="p">),</span>

        <span class="c1"># DISABILITY WEIGHT PROBABILITIES</span>
        <span class="s1">&#39;probs_for_mild_preterm_daly_wts_&lt;32wks&#39;</span><span class="p">:</span> <span class="n">Parameter</span><span class="p">(</span>
            <span class="n">Types</span><span class="o">.</span><span class="n">LIST</span><span class="p">,</span> <span class="s1">&#39;Probabilities (sum to one) that a newborn delivered at less than 32 weeks AND experiencing &#39;</span>
                        <span class="s1">&#39;mild impairment will accrue the DALY weight 357 (&quot;mild motor and cognitive impairment&quot;) or &#39;</span>
                        <span class="s1">&#39;DALY weight 371 (&quot;mild motor impairment&quot;)&#39;</span><span class="p">),</span>
        <span class="s1">&#39;probs_for_sev_preterm_daly_wts_&lt;32wks&#39;</span><span class="p">:</span> <span class="n">Parameter</span><span class="p">(</span>
            <span class="n">Types</span><span class="o">.</span><span class="n">LIST</span><span class="p">,</span> <span class="s1">&#39;Probabilities (sum to one) that a newborn delivered at less than 32 weeks AND experiencing &#39;</span>
                        <span class="s1">&#39;moderate/severe impairment will accrue the DALY weight 378 (&quot;moderate motor impairment&quot;) or &#39;</span>
                        <span class="s1">&#39;DALY weight 383 (&quot;severe motor impairment&quot;)&#39;</span><span class="p">),</span>
        <span class="s1">&#39;probs_for_mild_preterm_daly_wts_&gt;32wks&#39;</span><span class="p">:</span> <span class="n">Parameter</span><span class="p">(</span>
            <span class="n">Types</span><span class="o">.</span><span class="n">LIST</span><span class="p">,</span> <span class="s1">&#39;Probabilities (sum to one) that a newborn delivered at greater than 32 weeks AND experiencing &#39;</span>
                        <span class="s1">&#39;mild impairment will accrue the DALY weight 357 (&quot;mild motor and cognitive impairment&quot;) or &#39;</span>
                        <span class="s1">&#39;DALY weight 371 (&quot;mild motor impairment&quot;)&#39;</span><span class="p">),</span>
        <span class="s1">&#39;probs_for_sev_preterm_daly_wts_&gt;32wks&#39;</span><span class="p">:</span> <span class="n">Parameter</span><span class="p">(</span>
            <span class="n">Types</span><span class="o">.</span><span class="n">LIST</span><span class="p">,</span> <span class="s1">&#39;Probabilities (sum to one) that a newborn delivered at less than 32 weeks AND experiencing &#39;</span>
                        <span class="s1">&#39;moderate/severe impairment will accrue the DALY weight 378 (&quot;moderate motor impairment&quot;) or &#39;</span>
                        <span class="s1">&#39;DALY weight 383 (&quot;severe motor impairment&quot;)&#39;</span><span class="p">),</span>
        <span class="s1">&#39;probs_for_mild_enceph_daly_wts&#39;</span><span class="p">:</span> <span class="n">Parameter</span><span class="p">(</span>
            <span class="n">Types</span><span class="o">.</span><span class="n">LIST</span><span class="p">,</span> <span class="s1">&#39;Probabilities (sum to one) that a newborn delivered who develops encephalopathy AND &#39;</span>
                        <span class="s1">&#39;experiencing mild impairment will accrue the DALY weight 419 (&quot;mild motor and cognitive&#39;</span>
                        <span class="s1">&#39; impairment&quot;) or DALY weight 416 (&quot;mild motor impairment&quot;)&#39;</span><span class="p">),</span>
        <span class="s1">&#39;probs_for_sev_enceph_daly_wts&#39;</span><span class="p">:</span> <span class="n">Parameter</span><span class="p">(</span>
            <span class="n">Types</span><span class="o">.</span><span class="n">LIST</span><span class="p">,</span> <span class="s1">&#39;Probabilities (sum to one) that a newborn delivered who develops encephalopathy AND &#39;</span>
                        <span class="s1">&#39;experiencing moderate/severe impairment will accrue the DALY weight 411 (&quot;moderate motor  &#39;</span>
                        <span class="s1">&#39; impairment&quot;) or DALY weight 410 (&quot;severe motor impairment&quot;)&#39;</span><span class="p">),</span>
        <span class="s1">&#39;probs_for_mild_sepsis_daly_wts&#39;</span><span class="p">:</span> <span class="n">Parameter</span><span class="p">(</span>
            <span class="n">Types</span><span class="o">.</span><span class="n">LIST</span><span class="p">,</span> <span class="s1">&#39;Probabilities (sum to one) that a newborn delivered who develops sepsis AND &#39;</span>
                        <span class="s1">&#39;experiencing mild impairment will accrue the DALY weight 411 (&quot;mild motor and cognitive&#39;</span>
                        <span class="s1">&#39; impairment&quot;) or DALY weight 431 (&quot;mild motor impairment&quot;)&#39;</span><span class="p">),</span>
        <span class="s1">&#39;probs_for_sev_sepsis_daly_wts&#39;</span><span class="p">:</span> <span class="n">Parameter</span><span class="p">(</span>
            <span class="n">Types</span><span class="o">.</span><span class="n">LIST</span><span class="p">,</span> <span class="s1">&#39;Probabilities (sum to one) that a newborn delivered who develops sepsis AND &#39;</span>
                        <span class="s1">&#39;experiencing moderate/severe impairment will accrue the DALY weight 438 (&quot;moderate motor  &#39;</span>
                        <span class="s1">&#39; impairment&quot;) or DALY weight 435 (&quot;severe motor impairment&quot;)&#39;</span><span class="p">),</span>

        <span class="c1"># TREATMENT...</span>
        <span class="s1">&#39;treatment_effect_inj_abx_sep&#39;</span><span class="p">:</span> <span class="n">Parameter</span><span class="p">(</span>
            <span class="n">Types</span><span class="o">.</span><span class="n">LIST</span><span class="p">,</span> <span class="s1">&#39;effect of injectable antibiotics treatment on reducing mortality from sepsis&#39;</span><span class="p">),</span>
        <span class="s1">&#39;treatment_effect_supp_care_sep&#39;</span><span class="p">:</span> <span class="n">Parameter</span><span class="p">(</span>
            <span class="n">Types</span><span class="o">.</span><span class="n">LIST</span><span class="p">,</span> <span class="s1">&#39;effect of full supportive care treatment on reducing mortality from sepsis&#39;</span><span class="p">),</span>
        <span class="s1">&#39;treatment_effect_cord_care&#39;</span><span class="p">:</span> <span class="n">Parameter</span><span class="p">(</span>
            <span class="n">Types</span><span class="o">.</span><span class="n">LIST</span><span class="p">,</span> <span class="s1">&#39;effect of full supportive care treatment on reducing incidence of sepsis&#39;</span><span class="p">),</span>
        <span class="s1">&#39;treatment_effect_clean_birth&#39;</span><span class="p">:</span> <span class="n">Parameter</span><span class="p">(</span>
            <span class="n">Types</span><span class="o">.</span><span class="n">LIST</span><span class="p">,</span> <span class="s1">&#39;effect of clean birth practices on reducing incidence of sepsis&#39;</span><span class="p">),</span>
        <span class="s1">&#39;treatment_effect_early_init_bf&#39;</span><span class="p">:</span> <span class="n">Parameter</span><span class="p">(</span>
            <span class="n">Types</span><span class="o">.</span><span class="n">LIST</span><span class="p">,</span> <span class="s1">&#39;effect of early initiation of breastfeeding on reducing incidence of sepsis&#39;</span><span class="p">),</span>
        <span class="s1">&#39;treatment_effect_resuscitation&#39;</span><span class="p">:</span> <span class="n">Parameter</span><span class="p">(</span>
            <span class="n">Types</span><span class="o">.</span><span class="n">LIST</span><span class="p">,</span> <span class="s1">&#39;effect of resuscitation on newborn mortality associated with encephalopathy&#39;</span><span class="p">),</span>
        <span class="s1">&#39;treatment_effect_resuscitation_preterm&#39;</span><span class="p">:</span> <span class="n">Parameter</span><span class="p">(</span>
            <span class="n">Types</span><span class="o">.</span><span class="n">LIST</span><span class="p">,</span> <span class="s1">&#39;effect of delayed resuscitation on newborn mortality associated with prematurity&#39;</span><span class="p">),</span>
        <span class="s1">&#39;treatment_effect_abx_prom&#39;</span><span class="p">:</span> <span class="n">Parameter</span><span class="p">(</span>
            <span class="n">Types</span><span class="o">.</span><span class="n">LIST</span><span class="p">,</span> <span class="s1">&#39;effect of antibiotics given to mothers experience PROM on risk of newborn sepsis &#39;</span><span class="p">),</span>
        <span class="s1">&#39;treatment_effect_steroid_preterm&#39;</span><span class="p">:</span> <span class="n">Parameter</span><span class="p">(</span>
            <span class="n">Types</span><span class="o">.</span><span class="n">LIST</span><span class="p">,</span> <span class="s1">&#39;relative risk of death for preterm neonates following administration of antenatal &#39;</span>
                        <span class="s1">&#39;corticosteroids&#39;</span><span class="p">),</span>
        <span class="s1">&#39;treatment_effect_kmc&#39;</span><span class="p">:</span> <span class="n">Parameter</span><span class="p">(</span>
            <span class="n">Types</span><span class="o">.</span><span class="n">LIST</span><span class="p">,</span> <span class="s1">&#39;treatment effect of kangaroo mother care on preterm mortality&#39;</span><span class="p">),</span>

        <span class="s1">&#39;squeeze_threshold_for_delay_three_nb_care&#39;</span><span class="p">:</span> <span class="n">Parameter</span><span class="p">(</span>
            <span class="n">Types</span><span class="o">.</span><span class="n">LIST</span><span class="p">,</span> <span class="s1">&#39;squeeze factor value over which an individual within a newborn HSI is said to experience &#39;</span>
                        <span class="s1">&#39;type 3 delay i.e. delay in receiving appropriate care&#39;</span><span class="p">),</span>

    <span class="p">}</span>

    <span class="n">PROPERTIES</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;nb_is_twin&#39;</span><span class="p">:</span> <span class="n">Property</span><span class="p">(</span><span class="n">Types</span><span class="o">.</span><span class="n">BOOL</span><span class="p">,</span> <span class="s1">&#39;whether this is part of a twin pair&#39;</span><span class="p">),</span>
        <span class="s1">&#39;nb_twin_sibling_id&#39;</span><span class="p">:</span> <span class="n">Property</span><span class="p">(</span><span class="n">Types</span><span class="o">.</span><span class="n">INT</span><span class="p">,</span> <span class="s1">&#39;id number of this twins sibling&#39;</span><span class="p">),</span>
        <span class="s1">&#39;nb_early_preterm&#39;</span><span class="p">:</span> <span class="n">Property</span><span class="p">(</span><span class="n">Types</span><span class="o">.</span><span class="n">BOOL</span><span class="p">,</span> <span class="s1">&#39;whether this neonate has been born early preterm (24-33 weeks &#39;</span>
                                                 <span class="s1">&#39;gestation)&#39;</span><span class="p">),</span>
        <span class="s1">&#39;nb_late_preterm&#39;</span><span class="p">:</span> <span class="n">Property</span><span class="p">(</span><span class="n">Types</span><span class="o">.</span><span class="n">BOOL</span><span class="p">,</span> <span class="s1">&#39;whether this neonate has been born late preterm (34-36 weeks &#39;</span>
                                                <span class="s1">&#39;gestation)&#39;</span><span class="p">),</span>
        <span class="s1">&#39;nb_preterm_birth_disab&#39;</span><span class="p">:</span> <span class="n">Property</span><span class="p">(</span><span class="n">Types</span><span class="o">.</span><span class="n">CATEGORICAL</span><span class="p">,</span> <span class="s1">&#39;Disability associated with preterm delivery&#39;</span><span class="p">,</span>
                                           <span class="n">categories</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="s1">&#39;mild_motor_and_cog&#39;</span><span class="p">,</span> <span class="s1">&#39;mild_motor&#39;</span><span class="p">,</span> <span class="s1">&#39;moderate_motor&#39;</span><span class="p">,</span>
                                                       <span class="s1">&#39;severe_motor&#39;</span><span class="p">]),</span>
        <span class="s1">&#39;nb_congenital_anomaly&#39;</span><span class="p">:</span> <span class="n">Property</span><span class="p">(</span><span class="n">Types</span><span class="o">.</span><span class="n">INT</span><span class="p">,</span> <span class="s1">&#39;Types of congenital anomaly of the newborn stored as bitset&#39;</span><span class="p">),</span>
        <span class="s1">&#39;nb_early_onset_neonatal_sepsis&#39;</span><span class="p">:</span> <span class="n">Property</span><span class="p">(</span><span class="n">Types</span><span class="o">.</span><span class="n">BOOL</span><span class="p">,</span> <span class="s1">&#39;whether this neonate has developed neonatal sepsis&#39;</span>
                                                               <span class="s1">&#39; following birth&#39;</span><span class="p">),</span>
        <span class="s1">&#39;nb_inj_abx_neonatal_sepsis&#39;</span><span class="p">:</span> <span class="n">Property</span><span class="p">(</span><span class="n">Types</span><span class="o">.</span><span class="n">BOOL</span><span class="p">,</span> <span class="s1">&#39;If this neonate has injectable antibiotics as treatment &#39;</span>
                                                           <span class="s1">&#39;for neonatal sepsis&#39;</span><span class="p">),</span>
        <span class="s1">&#39;nb_supp_care_neonatal_sepsis&#39;</span><span class="p">:</span> <span class="n">Property</span><span class="p">(</span><span class="n">Types</span><span class="o">.</span><span class="n">BOOL</span><span class="p">,</span> <span class="s1">&#39;If this neonate has received full supportive care for &#39;</span>
                                                             <span class="s1">&#39;neonatal sepsis (in hospital)&#39;</span><span class="p">),</span>
        <span class="s1">&#39;nb_neonatal_sepsis_disab&#39;</span><span class="p">:</span> <span class="n">Property</span><span class="p">(</span><span class="n">Types</span><span class="o">.</span><span class="n">CATEGORICAL</span><span class="p">,</span> <span class="s1">&#39;Disability associated neonatal sepsis&#39;</span><span class="p">,</span>
                                             <span class="n">categories</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="s1">&#39;mild_motor_and_cog&#39;</span><span class="p">,</span> <span class="s1">&#39;mild_motor&#39;</span><span class="p">,</span>
                                                         <span class="s1">&#39;moderate_motor&#39;</span><span class="p">,</span> <span class="s1">&#39;severe_motor&#39;</span><span class="p">]),</span>
        <span class="s1">&#39;nb_preterm_respiratory_distress&#39;</span><span class="p">:</span> <span class="n">Property</span><span class="p">(</span><span class="n">Types</span><span class="o">.</span><span class="n">BOOL</span><span class="p">,</span> <span class="s1">&#39;whether this preterm newborn has respiratory &#39;</span>
                                                                <span class="s1">&#39;distress syndrome (RDS)&#39;</span><span class="p">),</span>
        <span class="s1">&#39;nb_not_breathing_at_birth&#39;</span><span class="p">:</span> <span class="n">Property</span><span class="p">(</span><span class="n">Types</span><span class="o">.</span><span class="n">BOOL</span><span class="p">,</span> <span class="s1">&#39;whether this neonate has failed to transition to breathing &#39;</span>
                                                          <span class="s1">&#39;on their own following birth&#39;</span><span class="p">),</span>
        <span class="s1">&#39;nb_received_neonatal_resus&#39;</span><span class="p">:</span> <span class="n">Property</span><span class="p">(</span><span class="n">Types</span><span class="o">.</span><span class="n">BOOL</span><span class="p">,</span> <span class="s1">&#39;If this neonate has received resuscitation&#39;</span><span class="p">),</span>
        <span class="s1">&#39;nb_encephalopathy&#39;</span><span class="p">:</span> <span class="n">Property</span><span class="p">(</span><span class="n">Types</span><span class="o">.</span><span class="n">CATEGORICAL</span><span class="p">,</span> <span class="s1">&#39;None, mild encephalopathy, moderate encephalopathy, &#39;</span>
                                                         <span class="s1">&#39;severe encephalopathy&#39;</span><span class="p">,</span>
                                      <span class="n">categories</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="s1">&#39;mild_enceph&#39;</span><span class="p">,</span> <span class="s1">&#39;moderate_enceph&#39;</span><span class="p">,</span> <span class="s1">&#39;severe_enceph&#39;</span><span class="p">]),</span>
        <span class="s1">&#39;nb_encephalopathy_disab&#39;</span><span class="p">:</span> <span class="n">Property</span><span class="p">(</span><span class="n">Types</span><span class="o">.</span><span class="n">CATEGORICAL</span><span class="p">,</span> <span class="s1">&#39;Disability associated neonatal sepsis&#39;</span><span class="p">,</span>
                                            <span class="n">categories</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="s1">&#39;mild_motor_and_cog&#39;</span><span class="p">,</span> <span class="s1">&#39;mild_motor&#39;</span><span class="p">,</span>
                                                        <span class="s1">&#39;moderate_motor&#39;</span><span class="p">,</span> <span class="s1">&#39;severe_motor&#39;</span><span class="p">]),</span>
        <span class="s1">&#39;nb_retinopathy_prem&#39;</span><span class="p">:</span> <span class="n">Property</span><span class="p">(</span><span class="n">Types</span><span class="o">.</span><span class="n">CATEGORICAL</span><span class="p">,</span> <span class="s1">&#39;Level of visual disturbance due to retinopathy of&#39;</span>
                                                           <span class="s1">&#39; prematurity: None, mild, moderate, severe, blindness&#39;</span><span class="p">,</span>
                                        <span class="n">categories</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="s1">&#39;mild&#39;</span><span class="p">,</span> <span class="s1">&#39;moderate&#39;</span><span class="p">,</span> <span class="s1">&#39;severe&#39;</span><span class="p">,</span> <span class="s1">&#39;blindness&#39;</span><span class="p">]),</span>
        <span class="s1">&#39;nb_low_birth_weight_status&#39;</span><span class="p">:</span> <span class="n">Property</span><span class="p">(</span><span class="n">Types</span><span class="o">.</span><span class="n">CATEGORICAL</span><span class="p">,</span> <span class="s1">&#39;extremely low birth weight (&lt;1000g), &#39;</span>
                                                                  <span class="s1">&#39; very low birth weight (&lt;1500g), &#39;</span>
                                                                  <span class="s1">&#39;low birth weight (&lt;2500g),&#39;</span>
                                                                  <span class="s1">&#39;normal birth weight (&gt;2500g), macrosomia (&gt;4000g)&#39;</span><span class="p">,</span>
                                               <span class="n">categories</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;extremely_low_birth_weight&#39;</span><span class="p">,</span> <span class="s1">&#39;very_low_birth_weight&#39;</span><span class="p">,</span>
                                                           <span class="s1">&#39;low_birth_weight&#39;</span><span class="p">,</span> <span class="s1">&#39;normal_birth_weight&#39;</span><span class="p">,</span> <span class="s1">&#39;macrosomia&#39;</span><span class="p">]),</span>
        <span class="s1">&#39;nb_size_for_gestational_age&#39;</span><span class="p">:</span> <span class="n">Property</span><span class="p">(</span><span class="n">Types</span><span class="o">.</span><span class="n">CATEGORICAL</span><span class="p">,</span> <span class="s1">&#39;size for gestational age categories&#39;</span><span class="p">,</span>
                                                <span class="n">categories</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;small_for_gestational_age&#39;</span><span class="p">,</span> <span class="s1">&#39;average_for_gestational_age&#39;</span><span class="p">,</span>
                                                            <span class="s1">&#39;large_for_gestational_age&#39;</span><span class="p">]),</span>
        <span class="s1">&#39;nb_early_init_breastfeeding&#39;</span><span class="p">:</span> <span class="n">Property</span><span class="p">(</span><span class="n">Types</span><span class="o">.</span><span class="n">BOOL</span><span class="p">,</span> <span class="s1">&#39;whether this neonate initiated breastfeeding &#39;</span>
                                                            <span class="s1">&#39;within 1 hour of birth &#39;</span><span class="p">),</span>
        <span class="s1">&#39;nb_breastfeeding_status&#39;</span><span class="p">:</span> <span class="n">Property</span><span class="p">(</span><span class="n">Types</span><span class="o">.</span><span class="n">CATEGORICAL</span><span class="p">,</span> <span class="s1">&#39;How this neonate is being breastfed&#39;</span><span class="p">,</span>
                                            <span class="n">categories</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="s1">&#39;non_exclusive&#39;</span><span class="p">,</span> <span class="s1">&#39;exclusive&#39;</span><span class="p">]),</span>
        <span class="s1">&#39;nb_kangaroo_mother_care&#39;</span><span class="p">:</span> <span class="n">Property</span><span class="p">(</span><span class="n">Types</span><span class="o">.</span><span class="n">BOOL</span><span class="p">,</span> <span class="s1">&#39;whether this neonate received kangaroo mother care following &#39;</span>
                                                        <span class="s1">&#39;birth&#39;</span><span class="p">),</span>
        <span class="s1">&#39;nb_clean_birth&#39;</span><span class="p">:</span> <span class="n">Property</span><span class="p">(</span><span class="n">Types</span><span class="o">.</span><span class="n">BOOL</span><span class="p">,</span> <span class="s1">&#39;whether this neonate received clean birth practices at delivery&#39;</span><span class="p">),</span>
        <span class="s1">&#39;nb_received_cord_care&#39;</span><span class="p">:</span> <span class="n">Property</span><span class="p">(</span><span class="n">Types</span><span class="o">.</span><span class="n">BOOL</span><span class="p">,</span> <span class="s1">&#39;whether this neonate received chlorhexidine cord care&#39;</span><span class="p">),</span>
        <span class="s1">&#39;nb_death_after_birth&#39;</span><span class="p">:</span> <span class="n">Property</span><span class="p">(</span><span class="n">Types</span><span class="o">.</span><span class="n">BOOL</span><span class="p">,</span> <span class="s1">&#39;whether this child has died following complications after birth&#39;</span><span class="p">),</span>
        <span class="s1">&#39;nb_pnc_check&#39;</span><span class="p">:</span> <span class="n">Property</span><span class="p">(</span><span class="n">Types</span><span class="o">.</span><span class="n">INT</span><span class="p">,</span> <span class="s1">&#39;Number of postnatal checks received in the postnatal period&#39;</span><span class="p">),</span>
    <span class="p">}</span>

<div class="viewcode-block" id="NewbornOutcomes.read_parameters"><a class="viewcode-back" href="../../../reference/tlo.methods.newborn_outcomes.html#tlo.methods.newborn_outcomes.NewbornOutcomes.read_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">read_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_folder</span><span class="p">):</span>

        <span class="n">parameter_dataframe</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">resourcefilepath</span><span class="p">)</span> <span class="o">/</span> <span class="s1">&#39;ResourceFile_NewbornOutcomes.xlsx&#39;</span><span class="p">,</span>
                                            <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;parameter_values&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">load_parameters_from_dataframe</span><span class="p">(</span><span class="n">parameter_dataframe</span><span class="p">)</span>

        <span class="c1"># For the first period (2010-2015) we use the first value in each list as a parameter</span>
        <span class="n">pregnancy_helper_functions</span><span class="o">.</span><span class="n">update_current_parameter_dictionary</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">list_position</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

        <span class="c1"># Here we map &#39;disability&#39; parameters to associated DALY weights to be passed to the health burden module</span>
        <span class="k">if</span> <span class="s1">&#39;HealthBurden&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">modules</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;nb_daly_weights&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;mild_motor_cognitive_preterm&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="s1">&#39;HealthBurden&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get_daly_weight</span><span class="p">(</span><span class="mi">357</span><span class="p">),</span>
                <span class="s1">&#39;mild_motor_preterm&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="s1">&#39;HealthBurden&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get_daly_weight</span><span class="p">(</span><span class="mi">371</span><span class="p">),</span>
                <span class="s1">&#39;moderate_motor_preterm&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="s1">&#39;HealthBurden&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get_daly_weight</span><span class="p">(</span><span class="mi">378</span><span class="p">),</span>
                <span class="s1">&#39;severe_motor_preterm&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="s1">&#39;HealthBurden&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get_daly_weight</span><span class="p">(</span><span class="mi">383</span><span class="p">),</span>
                <span class="c1"># n.b. DALY weight for prematurity are separated by disability and gestation (&lt;28wks, 28-32wks etc) but</span>
                <span class="c1"># the weight doesnt differ by gestation, only severity- so has been condensed here</span>

                <span class="s1">&#39;mild_vision_rptb&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="s1">&#39;HealthBurden&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get_daly_weight</span><span class="p">(</span><span class="mi">404</span><span class="p">),</span>
                <span class="s1">&#39;moderate_vision_rptb&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="s1">&#39;HealthBurden&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get_daly_weight</span><span class="p">(</span><span class="mi">405</span><span class="p">),</span>
                <span class="s1">&#39;severe_vision_rptb&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="s1">&#39;HealthBurden&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get_daly_weight</span><span class="p">(</span><span class="mi">402</span><span class="p">),</span>
                <span class="s1">&#39;blindness_rptb&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="s1">&#39;HealthBurden&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get_daly_weight</span><span class="p">(</span><span class="mi">386</span><span class="p">),</span>

                <span class="s1">&#39;mild_motor_cognitive_enceph&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="s1">&#39;HealthBurden&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get_daly_weight</span><span class="p">(</span><span class="mi">419</span><span class="p">),</span>
                <span class="s1">&#39;mild_motor_enceph&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="s1">&#39;HealthBurden&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get_daly_weight</span><span class="p">(</span><span class="mi">416</span><span class="p">),</span>
                <span class="s1">&#39;moderate_motor_enceph&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="s1">&#39;HealthBurden&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get_daly_weight</span><span class="p">(</span><span class="mi">411</span><span class="p">),</span>
                <span class="s1">&#39;severe_motor_enceph&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="s1">&#39;HealthBurden&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get_daly_weight</span><span class="p">(</span><span class="mi">410</span><span class="p">),</span>

                <span class="s1">&#39;mild_motor_sepsis&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="s1">&#39;HealthBurden&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get_daly_weight</span><span class="p">(</span><span class="mi">431</span><span class="p">),</span>
                <span class="s1">&#39;moderate_motor_sepsis&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="s1">&#39;HealthBurden&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get_daly_weight</span><span class="p">(</span><span class="mi">438</span><span class="p">),</span>
                <span class="s1">&#39;severe_motor_sepsis&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="s1">&#39;HealthBurden&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get_daly_weight</span><span class="p">(</span><span class="mi">435</span><span class="p">),</span>
                <span class="s1">&#39;mild_motor_cognitive_sepsis&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="s1">&#39;HealthBurden&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get_daly_weight</span><span class="p">(</span><span class="mi">441</span><span class="p">)}</span></div>

<div class="viewcode-block" id="NewbornOutcomes.initialise_population"><a class="viewcode-back" href="../../../reference/tlo.methods.newborn_outcomes.html#tlo.methods.newborn_outcomes.NewbornOutcomes.initialise_population">[docs]</a>    <span class="k">def</span> <span class="nf">initialise_population</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">population</span><span class="p">):</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">population</span><span class="o">.</span><span class="n">props</span>

        <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">is_alive</span><span class="p">,</span> <span class="s1">&#39;nb_is_twin&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">is_alive</span><span class="p">,</span> <span class="s1">&#39;nb_twin_sibling_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">is_alive</span><span class="p">,</span> <span class="s1">&#39;nb_early_preterm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">is_alive</span><span class="p">,</span> <span class="s1">&#39;nb_late_preterm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">is_alive</span><span class="p">,</span> <span class="s1">&#39;nb_preterm_birth_disab&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span>
        <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">is_alive</span><span class="p">,</span> <span class="s1">&#39;nb_congenital_anomaly&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">is_alive</span><span class="p">,</span> <span class="s1">&#39;nb_early_onset_neonatal_sepsis&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">is_alive</span><span class="p">,</span> <span class="s1">&#39;nb_inj_abx_neonatal_sepsis&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">is_alive</span><span class="p">,</span> <span class="s1">&#39;nb_supp_care_neonatal_sepsis&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">is_alive</span><span class="p">,</span> <span class="s1">&#39;nb_neonatal_sepsis_disab&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span>
        <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">is_alive</span><span class="p">,</span> <span class="s1">&#39;nb_preterm_respiratory_distress&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">is_alive</span><span class="p">,</span> <span class="s1">&#39;nb_not_breathing_at_birth&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">is_alive</span><span class="p">,</span> <span class="s1">&#39;nb_received_neonatal_resus&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">is_alive</span><span class="p">,</span> <span class="s1">&#39;nb_encephalopathy&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span>
        <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">is_alive</span><span class="p">,</span> <span class="s1">&#39;nb_encephalopathy_disab&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span>
        <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">is_alive</span><span class="p">,</span> <span class="s1">&#39;nb_retinopathy_prem&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span>
        <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">is_alive</span><span class="p">,</span> <span class="s1">&#39;nb_low_birth_weight_status&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;normal_birth_weight&#39;</span>
        <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">is_alive</span><span class="p">,</span> <span class="s1">&#39;nb_size_for_gestational_age&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;average_for_gestational_age&#39;</span>
        <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">is_alive</span><span class="p">,</span> <span class="s1">&#39;nb_early_init_breastfeeding&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">is_alive</span><span class="p">,</span> <span class="s1">&#39;nb_breastfeeding_status&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span>
        <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">is_alive</span><span class="p">,</span> <span class="s1">&#39;nb_kangaroo_mother_care&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">is_alive</span><span class="p">,</span> <span class="s1">&#39;nb_clean_birth&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">is_alive</span><span class="p">,</span> <span class="s1">&#39;nb_received_cord_care&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">is_alive</span><span class="p">,</span> <span class="s1">&#39;nb_death_after_birth&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">is_alive</span><span class="p">,</span> <span class="s1">&#39;nb_pnc_check&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="c1"># We store congenital anomalies as bitset</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">congeintal_anomalies</span> <span class="o">=</span> <span class="n">BitsetHandler</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">population</span><span class="p">,</span> <span class="s1">&#39;nb_congenital_anomaly&#39;</span><span class="p">,</span>
                                                  <span class="p">[</span><span class="s1">&#39;heart&#39;</span><span class="p">,</span> <span class="s1">&#39;limb_musc_skeletal&#39;</span><span class="p">,</span> <span class="s1">&#39;urogenital&#39;</span><span class="p">,</span> <span class="s1">&#39;digestive&#39;</span><span class="p">,</span> <span class="s1">&#39;other&#39;</span><span class="p">])</span></div>

<div class="viewcode-block" id="NewbornOutcomes.get_and_store_newborn_item_codes"><a class="viewcode-back" href="../../../reference/tlo.methods.newborn_outcomes.html#tlo.methods.newborn_outcomes.NewbornOutcomes.get_and_store_newborn_item_codes">[docs]</a>    <span class="k">def</span> <span class="nf">get_and_store_newborn_item_codes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This function defines the required consumables for each intervention delivered during this module and stores</span>
<span class="sd">        them in a module level dictionary called within HSIs</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">get_list_of_items</span> <span class="o">=</span> <span class="n">pregnancy_helper_functions</span><span class="o">.</span><span class="n">get_list_of_items</span>

        <span class="c1"># ---------------------------------- IV DRUG ADMIN EQUIPMENT  -------------------------------------------------</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">item_codes_nb_consumables</span><span class="p">[</span><span class="s1">&#39;iv_drug_equipment&#39;</span><span class="p">]</span> <span class="o">=</span> \
            <span class="n">get_list_of_items</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;Cannula iv  (winged with injection pot) 18_each_CMST&#39;</span><span class="p">,</span>
                                     <span class="s1">&#39;Giving set iv administration + needle 15 drops/ml_each_CMST&#39;</span><span class="p">,</span>
                                     <span class="s1">&#39;Disposables gloves, powder free, 100 pieces per box&#39;</span><span class="p">])</span>

        <span class="c1"># ---------------------------------- BLOOD TEST EQUIPMENT ---------------------------------------------------</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">item_codes_nb_consumables</span><span class="p">[</span><span class="s1">&#39;blood_test_equipment&#39;</span><span class="p">]</span> <span class="o">=</span> \
            <span class="n">get_list_of_items</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;Disposables gloves, powder free, 100 pieces per box&#39;</span><span class="p">])</span>
        <span class="c1"># todo: remove entirely?</span>

        <span class="c1"># -------------------------------------------- VITAMIN K ------------------------------------------</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">item_codes_nb_consumables</span><span class="p">[</span><span class="s1">&#39;vitamin_k&#39;</span><span class="p">]</span> <span class="o">=</span> \
            <span class="n">get_list_of_items</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;vitamin K1  (phytomenadione) 1 mg/ml, 1 ml, inj._100_IDA&#39;</span><span class="p">])</span>

        <span class="c1"># -------------------------------------------- EYE CARE  ------------------------------------------</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">item_codes_nb_consumables</span><span class="p">[</span><span class="s1">&#39;eye_care&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_list_of_items</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;Tetracycline eye ointment, 1 %, tube 5 mg&#39;</span><span class="p">])</span>

        <span class="c1"># -------------------------------------------- RESUSCITATION ------------------------------------------</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">item_codes_nb_consumables</span><span class="p">[</span><span class="s1">&#39;resuscitation&#39;</span><span class="p">]</span> <span class="o">=</span> \
            <span class="n">get_list_of_items</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;Infant resuscitator, clear plastic + mask + bag_each_CMST&#39;</span><span class="p">])</span>

        <span class="c1"># ------------------------------------- SEPSIS - FULL SUPPORTIVE CARE ---------------------------------------</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">item_codes_nb_consumables</span><span class="p">[</span><span class="s1">&#39;sepsis_supportive_care&#39;</span><span class="p">]</span> <span class="o">=</span> \
            <span class="n">get_list_of_items</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;Benzylpenicillin 1g (1MU), PFR_Each_CMST&#39;</span><span class="p">,</span>
                                     <span class="s1">&#39;Gentamicin 40mg/ml, 2ml_each_CMST&#39;</span><span class="p">,</span>
                                     <span class="s1">&#39;Oxygen, 1000 liters, primarily with oxygen cylinders&#39;</span><span class="p">,</span>
                                     <span class="s1">&#39;Dextrose (glucose) 5%, 1000ml_each_CMST&#39;</span><span class="p">,</span>
                                     <span class="s1">&#39;Tube, feeding CH 8_each_CMST&#39;</span><span class="p">])</span>

        <span class="c1"># ---------------------------------------- SEPSIS - ANTIBIOTICS ---------------------------------------------</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">item_codes_nb_consumables</span><span class="p">[</span><span class="s1">&#39;sepsis_abx&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="n">get_list_of_items</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;Benzylpenicillin 1g (1MU), PFR_Each_CMST&#39;</span><span class="p">,</span>
                                     <span class="s1">&#39;Gentamicin 40mg/ml, 2ml_each_CMST&#39;</span><span class="p">])</span></div>

<div class="viewcode-block" id="NewbornOutcomes.initialise_simulation"><a class="viewcode-back" href="../../../reference/tlo.methods.newborn_outcomes.html#tlo.methods.newborn_outcomes.NewbornOutcomes.initialise_simulation">[docs]</a>    <span class="k">def</span> <span class="nf">initialise_simulation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sim</span><span class="p">):</span>
        <span class="c1"># We call the following function to store the required consumables for the simulation run within the appropriate</span>
        <span class="c1"># dictionary</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">get_and_store_newborn_item_codes</span><span class="p">()</span>

        <span class="c1"># ======================================= LINEAR MODEL EQUATIONS ==============================================</span>
        <span class="c1"># All linear equations used in this module are stored within the nb_newborn_equations</span>
        <span class="c1"># parameter below</span>

        <span class="n">params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_parameters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nb_linear_models</span> <span class="o">=</span> <span class="p">{</span>

            <span class="c1"># This equation is used to determine a newborns risk of early onset neonatal sepsis. Risk of early onset</span>
            <span class="c1"># sepsis is mitigated by a number of interventions</span>
            <span class="s1">&#39;early_onset_neonatal_sepsis&#39;</span><span class="p">:</span> <span class="n">LinearModel</span><span class="o">.</span><span class="n">custom</span><span class="p">(</span><span class="n">newborn_outcomes_lm</span><span class="o">.</span><span class="n">predict_early_onset_neonatal_sepsis</span><span class="p">,</span>
                                                              <span class="n">parameters</span><span class="o">=</span><span class="n">params</span><span class="p">),</span>

            <span class="c1"># This equation is used to determine a newborns risk of encephalopathy</span>
            <span class="s1">&#39;encephalopathy&#39;</span><span class="p">:</span> <span class="n">LinearModel</span><span class="o">.</span><span class="n">custom</span><span class="p">(</span><span class="n">newborn_outcomes_lm</span><span class="o">.</span><span class="n">predict_encephalopathy</span><span class="p">,</span> <span class="n">module</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span>
                                                 <span class="n">parameters</span><span class="o">=</span><span class="n">params</span><span class="p">),</span>

            <span class="c1"># This equation is used to determine a preterm newborns risk of respiratory distress syndrome</span>
            <span class="c1"># (secondary to incomplete lung development)</span>
            <span class="s1">&#39;rds_preterm&#39;</span><span class="p">:</span> <span class="n">LinearModel</span><span class="o">.</span><span class="n">custom</span><span class="p">(</span><span class="n">newborn_outcomes_lm</span><span class="o">.</span><span class="n">predict_rds_preterm</span><span class="p">,</span> <span class="n">module</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span>
                                              <span class="n">parameters</span><span class="o">=</span><span class="n">params</span><span class="p">),</span>

            <span class="c1"># This equation is used to determine a preterm newborns risk of death due to &#39;complications of prematurity&#39;</span>
            <span class="c1">#  not explicitly modelled here (therefore excluding sepsis, encephalopathy and RDS)</span>
            <span class="s1">&#39;preterm_other_death&#39;</span><span class="p">:</span> <span class="n">LinearModel</span><span class="o">.</span><span class="n">custom</span><span class="p">(</span>
                <span class="n">newborn_outcomes_lm</span><span class="o">.</span><span class="n">predict_preterm_birth_other_death</span><span class="p">,</span> <span class="n">parameters</span><span class="o">=</span><span class="n">params</span><span class="p">),</span>

            <span class="c1"># This equation is used to determine a the risk of death for a newborn who doesnt breathe at birth.</span>
            <span class="s1">&#39;neonatal_respiratory_depression_death&#39;</span><span class="p">:</span> <span class="n">LinearModel</span><span class="o">.</span><span class="n">custom</span><span class="p">(</span>
                <span class="n">newborn_outcomes_lm</span><span class="o">.</span><span class="n">predict_not_breathing_at_birth_death</span><span class="p">,</span> <span class="n">parameters</span><span class="o">=</span><span class="n">params</span><span class="p">),</span>

            <span class="c1"># This equations is used to determine the risk of death for encephalopathic newborns.</span>
            <span class="s1">&#39;encephalopathy_death&#39;</span><span class="p">:</span> <span class="n">LinearModel</span><span class="o">.</span><span class="n">custom</span><span class="p">(</span>
                <span class="n">newborn_outcomes_lm</span><span class="o">.</span><span class="n">predict_enceph_death</span><span class="p">,</span> <span class="n">parameters</span><span class="o">=</span><span class="n">params</span><span class="p">),</span>

            <span class="c1"># This equation is used to determine a newborns risk of death from sepsis</span>
            <span class="s1">&#39;early_onset_sepsis_death&#39;</span><span class="p">:</span> <span class="n">LinearModel</span><span class="o">.</span><span class="n">custom</span><span class="p">(</span>
                <span class="n">newborn_outcomes_lm</span><span class="o">.</span><span class="n">predict_neonatal_sepsis_death</span><span class="p">,</span> <span class="n">parameters</span><span class="o">=</span><span class="n">params</span><span class="p">),</span>

            <span class="c1"># This equation is used to determine a preterm newborns risk of death due to respiratory distress syndrome</span>
            <span class="s1">&#39;respiratory_distress_syndrome_death&#39;</span><span class="p">:</span> <span class="n">LinearModel</span><span class="o">.</span><span class="n">custom</span><span class="p">(</span>
                <span class="n">newborn_outcomes_lm</span><span class="o">.</span><span class="n">predict_respiratory_distress_death</span><span class="p">,</span> <span class="n">parameters</span><span class="o">=</span><span class="n">params</span><span class="p">)}</span>

        <span class="c1"># Finally we add this warning note to document that HIV testing will not occur if the correct module isnt</span>
        <span class="c1"># registered</span>
        <span class="k">if</span> <span class="s1">&#39;Hiv&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">modules</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="s1">&#39;message&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="s1">&#39;HIV module is not registered in this simulation run and therefore HIV &#39;</span>
                                             <span class="s1">&#39;testing will not happen in newborn care&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="NewbornOutcomes.eval"><a class="viewcode-back" href="../../../reference/tlo.methods.newborn_outcomes.html#tlo.methods.newborn_outcomes.NewbornOutcomes.eval">[docs]</a>    <span class="k">def</span> <span class="nf">eval</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">eq</span><span class="p">,</span> <span class="n">person_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This function compares the result of a specific linear equation with a random draw providing</span>
<span class="sd">        a boolean for the outcome under examination. For equations that require external variables,</span>
<span class="sd">        they are also defined here</span>
<span class="sd">        :param eq: The linear model equation being evaluated</span>
<span class="sd">        :param person_id: person_id</span>
<span class="sd">        :return: BOOL outcome</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">population</span><span class="o">.</span><span class="n">props</span>
        <span class="n">nci</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">newborn_care_info</span>
        <span class="n">person</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="n">person_id</span><span class="p">]]</span>

        <span class="c1"># Here we define all the possible external variables used in the linear model</span>
        <span class="n">steroid_status</span> <span class="o">=</span> <span class="n">nci</span><span class="p">[</span><span class="n">person_id</span><span class="p">][</span><span class="s1">&#39;corticosteroids_given&#39;</span><span class="p">]</span>
        <span class="n">abx_for_prom</span> <span class="o">=</span> <span class="n">nci</span><span class="p">[</span><span class="n">person_id</span><span class="p">][</span><span class="s1">&#39;abx_for_prom_given&#39;</span><span class="p">]</span>

        <span class="n">chorio</span> <span class="o">=</span> <span class="n">nci</span><span class="p">[</span><span class="n">person_id</span><span class="p">][</span><span class="s1">&#39;maternal_chorio&#39;</span><span class="p">]</span>

        <span class="c1"># We return a BOOLEAN</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rng</span><span class="o">.</span><span class="n">random_sample</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">eq</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">person</span><span class="p">,</span>
                                                           <span class="n">received_corticosteroids</span><span class="o">=</span><span class="n">steroid_status</span><span class="p">,</span>
                                                           <span class="n">received_abx_for_prom</span><span class="o">=</span><span class="n">abx_for_prom</span><span class="p">,</span>
                                                           <span class="n">maternal_chorioamnionitis</span><span class="o">=</span><span class="n">chorio</span><span class="p">,</span>
                                                           <span class="p">)[</span><span class="n">person_id</span><span class="p">]</span></div>

    <span class="c1"># ========================================= OUTCOME FUNCTIONS  ===================================================</span>
    <span class="c1"># These functions are called within the on_birth function or</span>
    <span class="c1"># HSI_NewbornOutcomes_CareOfTheNewbornBySkilledAttendant depending on location of delivery. Generally they</span>
    <span class="c1"># output an individuals probability of an outcome (complication, disability, death) and make the relevant changes</span>
    <span class="c1"># to the data frame</span>

<div class="viewcode-block" id="NewbornOutcomes.apply_risk_of_congenital_anomaly"><a class="viewcode-back" href="../../../reference/tlo.methods.newborn_outcomes.html#tlo.methods.newborn_outcomes.NewbornOutcomes.apply_risk_of_congenital_anomaly">[docs]</a>    <span class="k">def</span> <span class="nf">apply_risk_of_congenital_anomaly</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">child_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This function determines if a neonate has been born with one of the common congenital anomalies.</span>
<span class="sd">        It is called during the on_birth function.</span>
<span class="sd">        :param child_id: child_id</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_parameters</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rng</span><span class="o">.</span><span class="n">random_sample</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;prob_congenital_heart_anomaly&#39;</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">congeintal_anomalies</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">child_id</span><span class="p">,</span> <span class="s1">&#39;heart&#39;</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="s1">&#39;newborn_complication&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;newborn&#39;</span><span class="p">:</span> <span class="n">child_id</span><span class="p">,</span>
                                                          <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;congenital_heart_anomaly&#39;</span><span class="p">})</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rng</span><span class="o">.</span><span class="n">random_sample</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;prob_limb_musc_skeletal_anomaly&#39;</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">congeintal_anomalies</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">child_id</span><span class="p">,</span> <span class="s1">&#39;limb_musc_skeletal&#39;</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="s1">&#39;newborn_complication&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;newborn&#39;</span><span class="p">:</span> <span class="n">child_id</span><span class="p">,</span>
                                                          <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;limb_or_musculoskeletal_anomaly&#39;</span><span class="p">})</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rng</span><span class="o">.</span><span class="n">random_sample</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;prob_urogenital_anomaly&#39;</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">congeintal_anomalies</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">child_id</span><span class="p">,</span> <span class="s1">&#39;urogenital&#39;</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="s1">&#39;newborn_complication&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;newborn&#39;</span><span class="p">:</span> <span class="n">child_id</span><span class="p">,</span>
                                                          <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;urogenital_anomaly&#39;</span><span class="p">})</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rng</span><span class="o">.</span><span class="n">random_sample</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;prob_digestive_anomaly&#39;</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">congeintal_anomalies</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">child_id</span><span class="p">,</span> <span class="s1">&#39;digestive&#39;</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="s1">&#39;newborn_complication&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;newborn&#39;</span><span class="p">:</span> <span class="n">child_id</span><span class="p">,</span>
                                                          <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;digestive_anomaly&#39;</span><span class="p">})</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rng</span><span class="o">.</span><span class="n">random_sample</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;prob_other_anomaly&#39;</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">congeintal_anomalies</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">child_id</span><span class="p">,</span> <span class="s1">&#39;other&#39;</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="s1">&#39;newborn_complication&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;newborn&#39;</span><span class="p">:</span> <span class="n">child_id</span><span class="p">,</span>
                                                          <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;other_anomaly&#39;</span><span class="p">})</span></div>

<div class="viewcode-block" id="NewbornOutcomes.apply_risk_of_neonatal_infection_and_sepsis"><a class="viewcode-back" href="../../../reference/tlo.methods.newborn_outcomes.html#tlo.methods.newborn_outcomes.NewbornOutcomes.apply_risk_of_neonatal_infection_and_sepsis">[docs]</a>    <span class="k">def</span> <span class="nf">apply_risk_of_neonatal_infection_and_sepsis</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">child_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This function uses the linear model to determines if a neonate will develop early onset neonatal sepsis.</span>
<span class="sd">        It is called during the on_birth function or during HSI_NewbornOutcomes_CareOfTheNewbornBySkilledAttendantAt</span>
<span class="sd">        Birth dependent on delivery setting.</span>
<span class="sd">        :param child_id: child_id</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">population</span><span class="o">.</span><span class="n">props</span>

        <span class="c1"># The linear model calculates the individuals probability of early_onset_neonatal_sepsis</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nb_linear_models</span><span class="p">[</span><span class="s1">&#39;early_onset_neonatal_sepsis&#39;</span><span class="p">],</span> <span class="n">child_id</span><span class="p">):</span>
            <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">child_id</span><span class="p">,</span> <span class="s1">&#39;nb_early_onset_neonatal_sepsis&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="s1">&#39;newborn_complication&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;newborn&#39;</span><span class="p">:</span> <span class="n">child_id</span><span class="p">,</span>
                                                          <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;early_onset_sepsis&#39;</span><span class="p">})</span></div>

<div class="viewcode-block" id="NewbornOutcomes.apply_risk_of_encephalopathy"><a class="viewcode-back" href="../../../reference/tlo.methods.newborn_outcomes.html#tlo.methods.newborn_outcomes.NewbornOutcomes.apply_risk_of_encephalopathy">[docs]</a>    <span class="k">def</span> <span class="nf">apply_risk_of_encephalopathy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">child_id</span><span class="p">,</span> <span class="n">timing</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This function determines if a neonate will develop neonatal encephalopathy on birth or after birth</span>
<span class="sd">        (if they were not breathing), at what severity, and makes the appropriate changes to the data frame.</span>
<span class="sd">         It is called during the on_birth function or  during HSI_NewbornOutcomes_CareOfTheNewbornBySkilledAttendantAt</span>
<span class="sd">         Birth dependent on delivery setting.</span>
<span class="sd">        :param child_id: child_id</span>
<span class="sd">        :param timing: on_birth or after_birth</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_parameters</span>
        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">population</span><span class="o">.</span><span class="n">props</span>

        <span class="c1"># We use a linear model equation to determine risk of encephalopathy on birth</span>
        <span class="k">if</span> <span class="n">timing</span> <span class="o">==</span> <span class="s1">&#39;on_birth&#39;</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nb_linear_models</span><span class="p">[</span><span class="s1">&#39;encephalopathy&#39;</span><span class="p">],</span> <span class="n">child_id</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Or, if we are applying risk to a non-encephalopathic newborn who was not breathing at birth</span>
            <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rng</span><span class="o">.</span><span class="n">random_sample</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;prob_enceph_no_resus&#39;</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">result</span><span class="p">:</span>
            <span class="c1"># For a newborn who is encephalopathic we then set the severity using a weighted probability derived from</span>
            <span class="c1"># the prevalence of severity of encephalopathy in the encephalopathic population</span>
            <span class="n">severity_enceph</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rng</span><span class="o">.</span><span class="n">choice</span><span class="p">((</span><span class="s1">&#39;mild&#39;</span><span class="p">,</span> <span class="s1">&#39;moderate&#39;</span><span class="p">,</span> <span class="s1">&#39;severe&#39;</span><span class="p">),</span> <span class="n">p</span><span class="o">=</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;prob_enceph_severity&#39;</span><span class="p">])</span>

            <span class="k">if</span> <span class="n">severity_enceph</span> <span class="o">==</span> <span class="s1">&#39;mild&#39;</span><span class="p">:</span>
                <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">child_id</span><span class="p">,</span> <span class="s1">&#39;nb_encephalopathy&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;mild_enceph&#39;</span>
            <span class="k">elif</span> <span class="n">severity_enceph</span> <span class="o">==</span> <span class="s1">&#39;moderate&#39;</span><span class="p">:</span>
                <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">child_id</span><span class="p">,</span> <span class="s1">&#39;nb_encephalopathy&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;moderate_enceph&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">child_id</span><span class="p">,</span> <span class="s1">&#39;nb_encephalopathy&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;severe_enceph&#39;</span>

            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="s1">&#39;newborn_complication&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;newborn&#39;</span><span class="p">:</span> <span class="n">child_id</span><span class="p">,</span>
                                                          <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">child_id</span><span class="p">,</span> <span class="s2">&quot;nb_encephalopathy&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">})</span>

            <span class="c1"># Check all encephalopathy cases receive a grade</span>
            <span class="k">if</span> <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">child_id</span><span class="p">,</span> <span class="s1">&#39;nb_encephalopathy&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;none&#39;</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="s1">&#39;error&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Child </span><span class="si">{</span><span class="n">child_id</span><span class="si">}</span><span class="s1"> should have developed encephalopathy but didnt&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="NewbornOutcomes.apply_risk_of_preterm_respiratory_distress_syndrome"><a class="viewcode-back" href="../../../reference/tlo.methods.newborn_outcomes.html#tlo.methods.newborn_outcomes.NewbornOutcomes.apply_risk_of_preterm_respiratory_distress_syndrome">[docs]</a>    <span class="k">def</span> <span class="nf">apply_risk_of_preterm_respiratory_distress_syndrome</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">child_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This function uses the linear model to determine if a preterm neonate will develop respiratory distress</span>
<span class="sd">        syndrome. It is called during the on_birth function or during</span>
<span class="sd">        HSI_NewbornOutcomes_CareOfTheNewbornBySkilledAttendantAtBirth</span>
<span class="sd">        dependent on delivery setting.</span>
<span class="sd">        :param child_id: child_id</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">population</span><span class="o">.</span><span class="n">props</span>
        <span class="n">child</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">child_id</span><span class="p">]</span>

        <span class="c1"># Ensure only preterm infants have risk of RDS applied</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">child</span><span class="o">.</span><span class="n">nb_early_preterm</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">child</span><span class="o">.</span><span class="n">nb_late_preterm</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="c1"># Use the linear model to calculate individual risk and make changes</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nb_linear_models</span><span class="p">[</span><span class="s1">&#39;rds_preterm&#39;</span><span class="p">],</span> <span class="n">child_id</span><span class="p">):</span>
            <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">child_id</span><span class="p">,</span> <span class="s1">&#39;nb_preterm_respiratory_distress&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="s1">&#39;newborn_complication&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;newborn&#39;</span><span class="p">:</span> <span class="n">child_id</span><span class="p">,</span>
                                                          <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;respiratory_distress_syndrome&#39;</span><span class="p">})</span></div>

<div class="viewcode-block" id="NewbornOutcomes.apply_risk_of_not_breathing_at_birth"><a class="viewcode-back" href="../../../reference/tlo.methods.newborn_outcomes.html#tlo.methods.newborn_outcomes.NewbornOutcomes.apply_risk_of_not_breathing_at_birth">[docs]</a>    <span class="k">def</span> <span class="nf">apply_risk_of_not_breathing_at_birth</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">child_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This function uses the linear model to determines if a neonate will not sufficiently initiate breathing at birth</span>
<span class="sd">         and makes the appropriate changes to the data frame. It is called during the on_birth function or</span>
<span class="sd">        during HSI_NewbornOutcomes_CareOfTheNewbornBySkilledAttendant dependent on delivery setting.</span>
<span class="sd">        :param child_id: child_id</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">population</span><span class="o">.</span><span class="n">props</span>
        <span class="n">params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_parameters</span>

        <span class="c1"># We assume all newborns with encephalopathy and respiratory distress syndrome will require some form of</span>
        <span class="c1"># resuscitation and will not be effectively breathing at birth</span>
        <span class="k">if</span> <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">child_id</span><span class="p">,</span> <span class="s1">&#39;nb_encephalopathy&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;none&#39;</span> <span class="ow">or</span> <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">child_id</span><span class="p">,</span> <span class="s1">&#39;nb_preterm_respiratory_distress&#39;</span><span class="p">]:</span>
            <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">child_id</span><span class="p">,</span> <span class="s1">&#39;nb_not_breathing_at_birth&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="c1"># Otherwise we use a probability to demonstrate risk of inadequate breathing due to other causes not</span>
        <span class="c1"># explicitly modelled</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">rng</span><span class="o">.</span><span class="n">random_sample</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;prob_failure_to_transition&#39;</span><span class="p">]:</span>
            <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">child_id</span><span class="p">,</span> <span class="s1">&#39;nb_not_breathing_at_birth&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="s1">&#39;newborn_complication&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;newborn&#39;</span><span class="p">:</span> <span class="n">child_id</span><span class="p">,</span>
                                                          <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;not_breathing_at_birth&#39;</span><span class="p">})</span></div>

<div class="viewcode-block" id="NewbornOutcomes.scheduled_week_one_postnatal_event"><a class="viewcode-back" href="../../../reference/tlo.methods.newborn_outcomes.html#tlo.methods.newborn_outcomes.NewbornOutcomes.scheduled_week_one_postnatal_event">[docs]</a>    <span class="k">def</span> <span class="nf">scheduled_week_one_postnatal_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">individual_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This function schedules PostnatalWeekOneNeonatalEvent within the Postnatal Supervisor module. Date on which the</span>
<span class="sd">         newborn attends is randomly spread across the first week of life</span>
<span class="sd">        :param individual_id: individual_id</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">nci</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">newborn_care_info</span>
        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">population</span><span class="o">.</span><span class="n">props</span>
        <span class="n">params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_parameters</span>

        <span class="c1"># Only run this function on newborns are yet to reach the postnatal period</span>
        <span class="k">if</span> <span class="n">nci</span><span class="p">[</span><span class="n">individual_id</span><span class="p">][</span><span class="s1">&#39;passed_through_week_one&#39;</span><span class="p">]:</span>
            <span class="k">return</span>

        <span class="n">days_post_birth_td</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">date</span> <span class="o">-</span> <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">individual_id</span><span class="p">,</span> <span class="s1">&#39;date_of_birth&#39;</span><span class="p">]</span>
        <span class="n">days_post_birth_int</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">days_post_birth_td</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">timedelta64</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">))</span>

        <span class="c1"># Ensure that these newborns are less than one week old and scheduled the event accordingly</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">days_post_birth_int</span> <span class="o">&lt;</span> <span class="mi">6</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="s1">&#39;error&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Child </span><span class="si">{</span><span class="n">individual_id</span><span class="si">}</span><span class="s1"> was older than 6 days when &#39;</span>
                                           <span class="sa">f</span><span class="s1">&#39;PostnatalWeekOneNeonatalEvent was scheduled&#39;</span><span class="p">)</span>

        <span class="n">day_for_event</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rng</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="n">p</span><span class="o">=</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;prob_day_reaches_week_one_event&#39;</span><span class="p">]))</span>

        <span class="c1"># Ensure no newborns go to this event after week 1</span>
        <span class="k">if</span> <span class="n">day_for_event</span> <span class="o">+</span> <span class="n">days_post_birth_int</span> <span class="o">&gt;</span> <span class="mi">6</span><span class="p">:</span>
            <span class="n">day_for_event</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">schedule_event</span><span class="p">(</span>
            <span class="n">PostnatalWeekOneNeonatalEvent</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="s1">&#39;PostnatalSupervisor&#39;</span><span class="p">],</span> <span class="n">individual_id</span><span class="p">),</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">date</span> <span class="o">+</span> <span class="n">DateOffset</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="n">day_for_event</span><span class="p">))</span></div>

<div class="viewcode-block" id="NewbornOutcomes.set_death_status"><a class="viewcode-back" href="../../../reference/tlo.methods.newborn_outcomes.html#tlo.methods.newborn_outcomes.NewbornOutcomes.set_death_status">[docs]</a>    <span class="k">def</span> <span class="nf">set_death_status</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">individual_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This function cycles through each complication of which a newborn may die, if the newborn has experienced one or</span>
<span class="sd">         more of these complication it calculates overall risk of death and then the probability that each complication</span>
<span class="sd">         was the primary cause of death. This information is logged and the death event is scheduled.</span>
<span class="sd">        :param individual_id: individual_id</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">population</span><span class="o">.</span><span class="n">props</span>
        <span class="n">nci</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">newborn_care_info</span>
        <span class="n">mni</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="s1">&#39;PregnancySupervisor&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mother_and_newborn_info</span>
        <span class="n">params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_parameters</span>

        <span class="c1"># Function checks df for any potential cause of death, uses CFR parameters to determine risk of death</span>
        <span class="c1"># (either from one or multiple causes) and if death occurs returns the cause</span>
        <span class="n">potential_cause_of_death</span> <span class="o">=</span> <span class="n">pregnancy_helper_functions</span><span class="o">.</span><span class="n">check_for_risk_of_death_from_cause_neonatal</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">individual_id</span><span class="o">=</span><span class="n">individual_id</span><span class="p">)</span>

        <span class="c1"># If a cause is returned death is scheduled</span>
        <span class="k">if</span> <span class="n">potential_cause_of_death</span><span class="p">:</span>

            <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">individual_id</span><span class="p">,</span> <span class="s1">&#39;nb_death_after_birth&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

            <span class="k">if</span> <span class="n">individual_id</span> <span class="ow">in</span> <span class="n">nci</span><span class="p">:</span>
                <span class="k">del</span> <span class="n">nci</span><span class="p">[</span><span class="n">individual_id</span><span class="p">]</span>

            <span class="c1"># If the death is associated with prematurity we scatter those deaths across the first 2 weeks</span>
            <span class="k">if</span> <span class="n">potential_cause_of_death</span> <span class="o">==</span> <span class="s1">&#39;preterm_other&#39;</span><span class="p">:</span>
                <span class="n">random_draw</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rng</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">],</span>
                                              <span class="n">p</span><span class="o">=</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;prob_preterm_death_by_day&#39;</span><span class="p">])</span>
                <span class="n">death_date</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">date</span> <span class="o">+</span> <span class="n">DateOffset</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">random_draw</span><span class="p">))</span>

            <span class="c1"># Similarly, if death is associated with congential anomaly we schedule death across the life coarse to</span>
            <span class="c1"># align with GBD estimates</span>
            <span class="k">elif</span> <span class="s1">&#39;anomaly&#39;</span> <span class="ow">in</span> <span class="n">potential_cause_of_death</span><span class="p">:</span>

                <span class="n">days_per_year</span> <span class="o">=</span> <span class="mf">365.25</span>
                <span class="c1"># Generate the minimum and maximum number of days within the age group to allow for random</span>
                <span class="c1"># distribution within each group</span>
                <span class="n">days_per_age_group</span> <span class="o">=</span> \
                    <span class="p">{</span><span class="s1">&#39;early_n&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
                     <span class="s1">&#39;late_n&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">28</span><span class="p">],</span>
                     <span class="s1">&#39;post_n&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">29</span><span class="p">,</span> <span class="mi">364</span><span class="p">],</span>
                     <span class="s1">&#39;1-4&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">days_per_year</span><span class="p">,</span> <span class="p">((</span><span class="mi">5</span> <span class="o">*</span> <span class="n">days_per_year</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)],</span>
                     <span class="s1">&#39;5-9&#39;</span><span class="p">:</span> <span class="p">[(</span><span class="mi">5</span> <span class="o">*</span> <span class="n">days_per_year</span><span class="p">),</span> <span class="p">((</span><span class="mi">10</span> <span class="o">*</span> <span class="n">days_per_year</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)],</span>
                     <span class="s1">&#39;10-14&#39;</span><span class="p">:</span> <span class="p">[(</span><span class="mi">10</span> <span class="o">*</span> <span class="n">days_per_year</span><span class="p">),</span> <span class="p">((</span><span class="mi">15</span> <span class="o">*</span> <span class="n">days_per_year</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)],</span>
                     <span class="s1">&#39;15-69&#39;</span><span class="p">:</span> <span class="p">[(</span><span class="mi">15</span> <span class="o">*</span> <span class="n">days_per_year</span><span class="p">),</span> <span class="p">((</span><span class="mi">70</span> <span class="o">*</span> <span class="n">days_per_year</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)]}</span>

                <span class="n">random_draw</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rng</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">days_per_age_group</span><span class="o">.</span><span class="n">keys</span><span class="p">()),</span> <span class="n">p</span><span class="o">=</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;prob_cba_death_by_age_group&#39;</span><span class="p">])</span>

                <span class="n">onset_day</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rng</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">days_per_age_group</span><span class="p">[</span><span class="n">random_draw</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
                                             <span class="n">days_per_age_group</span><span class="p">[</span><span class="n">random_draw</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>

                <span class="n">death_date</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">date</span> <span class="o">+</span> <span class="n">DateOffset</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="n">onset_day</span><span class="p">)</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">death_date</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">date</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">schedule_event</span><span class="p">(</span><span class="n">demography</span><span class="o">.</span><span class="n">InstantaneousDeath</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">individual_id</span><span class="p">,</span>
                                                                  <span class="n">cause</span><span class="o">=</span><span class="n">potential_cause_of_death</span><span class="p">),</span> <span class="n">death_date</span><span class="p">)</span>
        <span class="c1"># Reset variables</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">individual_id</span><span class="p">,</span> <span class="s1">&#39;nb_early_onset_neonatal_sepsis&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">individual_id</span><span class="p">,</span> <span class="s1">&#39;pn_sepsis_early_neonatal&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">individual_id</span><span class="p">,</span> <span class="s1">&#39;pn_sepsis_late_neonatal&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="c1"># Finally we schedule the postnatal week one event</span>
        <span class="k">if</span> <span class="n">individual_id</span> <span class="ow">in</span> <span class="n">nci</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">nci</span><span class="p">[</span><span class="n">individual_id</span><span class="p">][</span><span class="s1">&#39;passed_through_week_one&#39;</span><span class="p">]:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">scheduled_week_one_postnatal_event</span><span class="p">(</span><span class="n">individual_id</span><span class="p">)</span>

        <span class="c1"># We now delete the MNI dictionary for mothers who have died in labour but their children have survived,</span>
        <span class="c1"># this is done here as we use variables from the mni as predictors in some of the above equations</span>
        <span class="n">mother_id</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">individual_id</span><span class="p">,</span> <span class="s1">&#39;mother_id&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">mother_id</span><span class="p">,</span> <span class="s1">&#39;is_alive&#39;</span><span class="p">]:</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">mother_id</span> <span class="ow">in</span> <span class="n">mni</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">mother_id</span><span class="p">,</span> <span class="s1">&#39;ps_multiple_pregnancy&#39;</span><span class="p">]</span> <span class="ow">or</span>
               <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">mother_id</span><span class="p">,</span> <span class="s1">&#39;ps_multiple_pregnancy&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="p">(</span><span class="n">mni</span><span class="p">[</span><span class="n">mother_id</span><span class="p">][</span><span class="s1">&#39;twin_count&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)))):</span>
                <span class="k">del</span> <span class="n">mni</span><span class="p">[</span><span class="n">mother_id</span><span class="p">]</span></div>

<div class="viewcode-block" id="NewbornOutcomes.set_disability_status"><a class="viewcode-back" href="../../../reference/tlo.methods.newborn_outcomes.html#tlo.methods.newborn_outcomes.NewbornOutcomes.set_disability_status">[docs]</a>    <span class="k">def</span> <span class="nf">set_disability_status</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">individual_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This function cycles through each complication experience by a newborn during birth/neonatal period and</span>
<span class="sd">        determines if this newborn will experience long term developmental impairment due to said complication. It is</span>
<span class="sd">        called at the end of the neonatal period by the PostnatalSupervisor event for survivors of the neonatal period.</span>
<span class="sd">        :param individual_id: individual_id</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">nci</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">newborn_care_info</span>
        <span class="n">params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_parameters</span>
        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">population</span><span class="o">.</span><span class="n">props</span>
        <span class="n">child</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">individual_id</span><span class="p">]</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="s1">&#39;message&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Child </span><span class="si">{</span><span class="n">individual_id</span><span class="si">}</span><span class="s1"> will have now their DALYs calculated following &#39;</span>
                                         <span class="sa">f</span><span class="s1">&#39;complications after birth&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">individual_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">nci</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">rng</span><span class="o">.</span><span class="n">choice</span><span class="p">((</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="s1">&#39;non_exclusive&#39;</span><span class="p">,</span> <span class="s1">&#39;exclusive&#39;</span><span class="p">),</span> <span class="n">p</span><span class="o">=</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;prob_breastfeeding_type&#39;</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">nci</span><span class="p">[</span><span class="n">individual_id</span><span class="p">][</span><span class="s1">&#39;ga_at_birth&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">32</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rng</span><span class="o">.</span><span class="n">random_sample</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;prob_mild_disability_preterm_&lt;32weeks&#39;</span><span class="p">]:</span>
                <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">individual_id</span><span class="p">,</span> <span class="s1">&#39;nb_preterm_birth_disab&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rng</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span>
                    <span class="p">(</span><span class="s1">&#39;mild_motor_and_cog&#39;</span><span class="p">,</span> <span class="s1">&#39;mild_motor&#39;</span><span class="p">),</span> <span class="n">p</span><span class="o">=</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;probs_for_mild_preterm_daly_wts_&lt;32wks&#39;</span><span class="p">])</span>

            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">rng</span><span class="o">.</span><span class="n">random_sample</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;prob_mod_severe_disability_preterm_&lt;32weeks&#39;</span><span class="p">]:</span>
                <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">individual_id</span><span class="p">,</span> <span class="s1">&#39;nb_preterm_birth_disab&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rng</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span>
                    <span class="p">(</span><span class="s1">&#39;moderate_motor&#39;</span><span class="p">,</span> <span class="s1">&#39;severe_motor&#39;</span><span class="p">),</span> <span class="n">p</span><span class="o">=</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;probs_for_sev_preterm_daly_wts_&lt;32wks&#39;</span><span class="p">])</span>

        <span class="k">elif</span> <span class="mi">32</span> <span class="o">&lt;=</span> <span class="n">nci</span><span class="p">[</span><span class="n">individual_id</span><span class="p">][</span><span class="s1">&#39;ga_at_birth&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">37</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rng</span><span class="o">.</span><span class="n">random_sample</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;prob_mild_disability_preterm_32_36weeks&#39;</span><span class="p">]:</span>
                <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">individual_id</span><span class="p">,</span> <span class="s1">&#39;nb_preterm_birth_disab&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rng</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span>
                    <span class="p">(</span><span class="s1">&#39;mild_motor_and_cog&#39;</span><span class="p">,</span> <span class="s1">&#39;mild_motor&#39;</span><span class="p">),</span> <span class="n">p</span><span class="o">=</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;probs_for_mild_preterm_daly_wts_&gt;32wks&#39;</span><span class="p">])</span>

            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">rng</span><span class="o">.</span><span class="n">random_sample</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;prob_mod_severe_disability_preterm_32_36weeks&#39;</span><span class="p">]:</span>
                <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">individual_id</span><span class="p">,</span> <span class="s1">&#39;nb_preterm_birth_disab&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rng</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span>
                    <span class="p">(</span><span class="s1">&#39;moderate_motor&#39;</span><span class="p">,</span> <span class="s1">&#39;severe_motor&#39;</span><span class="p">),</span> <span class="n">p</span><span class="o">=</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;probs_for_sev_preterm_daly_wts_&gt;32wks&#39;</span><span class="p">])</span>

        <span class="k">if</span> <span class="n">child</span><span class="o">.</span><span class="n">nb_encephalopathy</span> <span class="o">!=</span> <span class="s1">&#39;none&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rng</span><span class="o">.</span><span class="n">random_sample</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;prob_mild_impairment_post_enceph&#39;</span><span class="p">]:</span>
                <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">individual_id</span><span class="p">,</span> <span class="s1">&#39;nb_encephalopathy_disab&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rng</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span>
                    <span class="p">(</span><span class="s1">&#39;mild_motor_and_cog&#39;</span><span class="p">,</span> <span class="s1">&#39;mild_motor&#39;</span><span class="p">),</span> <span class="n">p</span><span class="o">=</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;probs_for_mild_enceph_daly_wts&#39;</span><span class="p">])</span>

            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">rng</span><span class="o">.</span><span class="n">random_sample</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;prob_mod_severe_impairment_post_enceph&#39;</span><span class="p">]:</span>
                <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">individual_id</span><span class="p">,</span> <span class="s1">&#39;nb_encephalopathy_disab&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rng</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span>
                    <span class="p">(</span><span class="s1">&#39;moderate_motor&#39;</span><span class="p">,</span> <span class="s1">&#39;severe_motor&#39;</span><span class="p">),</span> <span class="n">p</span><span class="o">=</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;probs_for_sev_enceph_daly_wts&#39;</span><span class="p">])</span>

        <span class="c1"># n.b. no data data on sepsis long term outcomes, using encephalopathy data as a proxy for now...</span>
        <span class="k">if</span> <span class="n">child</span><span class="o">.</span><span class="n">nb_early_onset_neonatal_sepsis</span> <span class="ow">or</span> <span class="n">nci</span><span class="p">[</span><span class="n">individual_id</span><span class="p">][</span><span class="s1">&#39;sepsis_postnatal&#39;</span><span class="p">]:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rng</span><span class="o">.</span><span class="n">random_sample</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;prob_mild_impairment_post_enceph&#39;</span><span class="p">]:</span>
                <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">individual_id</span><span class="p">,</span> <span class="s1">&#39;nb_neonatal_sepsis_disab&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rng</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span>
                    <span class="p">(</span><span class="s1">&#39;mild_motor_and_cog&#39;</span><span class="p">,</span> <span class="s1">&#39;mild_motor&#39;</span><span class="p">),</span> <span class="n">p</span><span class="o">=</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;probs_for_mild_sepsis_daly_wts&#39;</span><span class="p">])</span>

            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">rng</span><span class="o">.</span><span class="n">random_sample</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;prob_mod_severe_impairment_post_enceph&#39;</span><span class="p">]:</span>
                <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">individual_id</span><span class="p">,</span> <span class="s1">&#39;nb_neonatal_sepsis_disab&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rng</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span>
                    <span class="p">(</span><span class="s1">&#39;moderate_motor&#39;</span><span class="p">,</span> <span class="s1">&#39;severe_motor&#39;</span><span class="p">),</span> <span class="n">p</span><span class="o">=</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;probs_for_sev_sepsis_daly_wts&#39;</span><span class="p">])</span>

        <span class="k">del</span> <span class="n">nci</span><span class="p">[</span><span class="n">individual_id</span><span class="p">]</span></div>

    <span class="c1"># ======================================== HSI INTERVENTION FUNCTIONS =============================================</span>
    <span class="c1"># These functions are called by HSI_NewbornOutcomes_CareOfTheNewbornBySkilledAttendant and broadly represent</span>
    <span class="c1"># interventions/packages of interventions to manage the main complications in the module</span>

<div class="viewcode-block" id="NewbornOutcomes.essential_newborn_care"><a class="viewcode-back" href="../../../reference/tlo.methods.newborn_outcomes.html#tlo.methods.newborn_outcomes.NewbornOutcomes.essential_newborn_care">[docs]</a>    <span class="k">def</span> <span class="nf">essential_newborn_care</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hsi_event</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This function contains interventions delivered as part of &#39;essential newborn care&#39;. These include clean birth</span>
<span class="sd">        practices, cord care, vitamin k and eye care</span>
<span class="sd">        :param hsi_event:  The HSI event in which this function is called</span>
<span class="sd">        (HSI_NewbornOutcomes_CareOfTheNewbornBySkilledAttendant)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">population</span><span class="o">.</span><span class="n">props</span>
        <span class="n">nci</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">newborn_care_info</span>
        <span class="n">person_id</span> <span class="o">=</span> <span class="n">hsi_event</span><span class="o">.</span><span class="n">target</span>
        <span class="n">cons</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">item_codes_nb_consumables</span>

        <span class="c1"># -------------------------------------- CHLORHEXIDINE CORD CARE ----------------------------------------------</span>
        <span class="c1"># Next we determine if cord care with chlorhexidine is applied (consumables are counted during labour)</span>
        <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">person_id</span><span class="p">,</span> <span class="s1">&#39;nb_received_cord_care&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="c1"># ---------------------------------- VITAMIN D AND EYE CARE -----------------------------------------------</span>
        <span class="c1"># We define the consumables</span>
        <span class="n">avail_eyecare</span> <span class="o">=</span> <span class="n">hsi_event</span><span class="o">.</span><span class="n">get_consumables</span><span class="p">(</span><span class="n">item_codes</span><span class="o">=</span><span class="n">cons</span><span class="p">[</span><span class="s1">&#39;eye_care&#39;</span><span class="p">])</span>
        <span class="n">avail_vit_k</span> <span class="o">=</span> <span class="n">hsi_event</span><span class="o">.</span><span class="n">get_consumables</span><span class="p">(</span><span class="n">item_codes</span><span class="o">=</span><span class="n">cons</span><span class="p">[</span><span class="s1">&#39;vitamin_k&#39;</span><span class="p">],</span>
                                                <span class="n">optional_item_codes</span><span class="o">=</span><span class="n">cons</span><span class="p">[</span><span class="s1">&#39;iv_drug_equipment&#39;</span><span class="p">])</span>

        <span class="c1"># If they are available the intervention is delivered, there is limited evidence of the effect of these</span>
        <span class="c1"># interventions so currently we are just mapping the consumables</span>
        <span class="k">if</span> <span class="n">avail_eyecare</span><span class="p">:</span>
            <span class="n">nci</span><span class="p">[</span><span class="n">person_id</span><span class="p">][</span><span class="s1">&#39;tetra_eye_d&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="c1"># This process is repeated for vitamin K</span>
        <span class="k">if</span> <span class="n">avail_vit_k</span><span class="p">:</span>
            <span class="n">nci</span><span class="p">[</span><span class="n">person_id</span><span class="p">][</span><span class="s1">&#39;vit_k&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="NewbornOutcomes.breast_feeding"><a class="viewcode-back" href="../../../reference/tlo.methods.newborn_outcomes.html#tlo.methods.newborn_outcomes.NewbornOutcomes.breast_feeding">[docs]</a>    <span class="k">def</span> <span class="nf">breast_feeding</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">person_id</span><span class="p">,</span> <span class="n">birth_setting</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This function is used to set breastfeeding status for newborns. It schedules the BreastfeedingStatusUpdateEvent</span>
<span class="sd">        for breastfed newborns. It is called during the</span>
<span class="sd">        on_birth function or during HSI_NewbornOutcomes_CareOfTheNewbornBySkilledAttendant dependent on delivery</span>
<span class="sd">        setting.</span>
<span class="sd">        :param person_id: person_id</span>
<span class="sd">        :param birth_setting: hf (health facility) or hb (home birth)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">population</span><span class="o">.</span><span class="n">props</span>
        <span class="n">params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_parameters</span>
        <span class="n">mni</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="s1">&#39;PregnancySupervisor&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mother_and_newborn_info</span>
        <span class="n">mother_id</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">person_id</span><span class="p">,</span> <span class="s1">&#39;mother_id&#39;</span><span class="p">]</span>

        <span class="c1"># We determine breastfeeding for non-twins or first born twins (second born twins will match first born for</span>
        <span class="c1"># breastfeeding type)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">person_id</span><span class="p">,</span> <span class="s1">&#39;nb_is_twin&#39;</span><span class="p">]</span> <span class="ow">or</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">mother_id</span><span class="p">,</span> <span class="s1">&#39;ps_multiple_pregnancy&#39;</span><span class="p">]</span> <span class="ow">and</span>
                                                  <span class="n">mni</span><span class="p">[</span><span class="n">mother_id</span><span class="p">][</span><span class="s1">&#39;twin_count&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>

            <span class="c1"># First we determine the &#39;type&#39; of breastfeeding this newborn will receive</span>
            <span class="n">random_draw</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rng</span><span class="o">.</span><span class="n">choice</span><span class="p">((</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="s1">&#39;non_exclusive&#39;</span><span class="p">,</span> <span class="s1">&#39;exclusive&#39;</span><span class="p">),</span> <span class="n">p</span><span class="o">=</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;prob_breastfeeding_type&#39;</span><span class="p">])</span>
            <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">person_id</span><span class="p">,</span> <span class="s1">&#39;nb_breastfeeding_status&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">random_draw</span>

            <span class="c1"># For newborns that are breastfed, we apply a probability that breastfeeding was initiated within one hour.</span>
            <span class="c1"># This varies between home births and facility deliveries</span>
            <span class="k">if</span> <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">person_id</span><span class="p">,</span> <span class="s1">&#39;nb_breastfeeding_status&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;none&#39;</span><span class="p">:</span>

                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rng</span><span class="o">.</span><span class="n">random_sample</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">params</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;prob_early_breastfeeding_</span><span class="si">{</span><span class="n">birth_setting</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]:</span>
                    <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">person_id</span><span class="p">,</span> <span class="s1">&#39;nb_early_init_breastfeeding&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

            <span class="c1"># We store the breastfeeding information of the first twin in a twin pair to ensure twins have the same</span>
            <span class="c1"># breastfeeding status</span>
            <span class="k">if</span> <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">mother_id</span><span class="p">,</span> <span class="s1">&#39;ps_multiple_pregnancy&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">mni</span><span class="p">[</span><span class="n">mother_id</span><span class="p">][</span><span class="s1">&#39;twin_count&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">mni</span><span class="p">[</span><span class="n">mother_id</span><span class="p">][</span><span class="s1">&#39;bf_status_twin_one&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">random_draw</span>
                <span class="n">mni</span><span class="p">[</span><span class="n">mother_id</span><span class="p">][</span><span class="s1">&#39;eibf_status_twin_one&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">person_id</span><span class="p">,</span> <span class="s1">&#39;nb_early_init_breastfeeding&#39;</span><span class="p">]</span>

        <span class="c1"># Here we set the breastfeeding status of any second born twins</span>
        <span class="k">elif</span> <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">mother_id</span><span class="p">,</span> <span class="s1">&#39;ps_multiple_pregnancy&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">mni</span><span class="p">[</span><span class="n">mother_id</span><span class="p">][</span><span class="s1">&#39;twin_count&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">person_id</span><span class="p">,</span> <span class="s1">&#39;nb_breastfeeding_status&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mni</span><span class="p">[</span><span class="n">mother_id</span><span class="p">][</span><span class="s1">&#39;bf_status_twin_one&#39;</span><span class="p">]</span>
            <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">person_id</span><span class="p">,</span> <span class="s1">&#39;nb_early_init_breastfeeding&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mni</span><span class="p">[</span><span class="n">mother_id</span><span class="p">][</span><span class="s1">&#39;eibf_status_twin_one&#39;</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">person_id</span><span class="p">,</span> <span class="s1">&#39;nb_breastfeeding_status&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;none&#39;</span><span class="p">:</span>
            <span class="c1"># For breastfed neonates we schedule a future event where breastfeeding status is updated</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">schedule_event</span><span class="p">(</span><span class="n">BreastfeedingStatusUpdateEventSixMonths</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">person_id</span><span class="p">),</span>
                                    <span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">date</span> <span class="o">+</span> <span class="n">DateOffset</span><span class="p">(</span><span class="n">months</span><span class="o">=</span><span class="mi">6</span><span class="p">))</span></div>

<div class="viewcode-block" id="NewbornOutcomes.kangaroo_mother_care"><a class="viewcode-back" href="../../../reference/tlo.methods.newborn_outcomes.html#tlo.methods.newborn_outcomes.NewbornOutcomes.kangaroo_mother_care">[docs]</a>    <span class="k">def</span> <span class="nf">kangaroo_mother_care</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hsi_event</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This function manages the diagnosis and treatment of low birth weight neonates who have</span>
<span class="sd">        delivered in a facility. It is called by the HSI_NewbornOutcomes_CareOfTheNewbornBySkilledAttendant.</span>
<span class="sd">        The intervention delivered is Kangaroo Mother Care (KMC) which includes skin-to-skin nursing and encouragement</span>
<span class="sd">        of frequent and exclusive breastfeeding</span>
<span class="sd">        :param hsi_event: The HSI event in which this function is called</span>
<span class="sd">        (HSI_NewbornOutcomes_CareOfTheNewbornBySkilledAttendant)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">population</span><span class="o">.</span><span class="n">props</span>
        <span class="n">person_id</span> <span class="o">=</span> <span class="n">hsi_event</span><span class="o">.</span><span class="n">target</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">person_id</span><span class="p">,</span> <span class="s1">&#39;nb_low_birth_weight_status&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;normal_birth_weight&#39;</span><span class="p">)</span> <span class="ow">or</span> \
           <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">person_id</span><span class="p">,</span> <span class="s1">&#39;nb_low_birth_weight_status&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;macrosomia&#39;</span><span class="p">):</span>

            <span class="c1"># Store treatment as a property of the newborn used to apply treatment effect</span>
            <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">person_id</span><span class="p">,</span> <span class="s1">&#39;nb_kangaroo_mother_care&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="NewbornOutcomes.hiv_screening_for_at_risk_newborns"><a class="viewcode-back" href="../../../reference/tlo.methods.newborn_outcomes.html#tlo.methods.newborn_outcomes.NewbornOutcomes.hiv_screening_for_at_risk_newborns">[docs]</a>    <span class="k">def</span> <span class="nf">hiv_screening_for_at_risk_newborns</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">child_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This function schedules immediate HIV screening for newborns of mothers who are HIV positive. Additional</span>
<span class="sd">         treatment is managed within the HIV module</span>
<span class="sd">        :param child_id: child_id</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">population</span><span class="o">.</span><span class="n">props</span>
        <span class="n">child_id</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">child_id</span><span class="p">)</span>

        <span class="k">if</span> <span class="s1">&#39;Hiv&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">modules</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">child_id</span><span class="p">,</span> <span class="s1">&#39;hv_diagnosed&#39;</span><span class="p">]:</span>

                <span class="k">if</span> <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">child_id</span><span class="p">,</span> <span class="s1">&#39;nb_pnc_check&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">days</span> <span class="ow">in</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">41</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="s1">&#39;HealthSystem&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">schedule_hsi_event</span><span class="p">(</span>
                            <span class="n">HSI_Hiv_TestAndRefer</span><span class="p">(</span><span class="n">person_id</span><span class="o">=</span><span class="n">child_id</span><span class="p">,</span> <span class="n">module</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="s1">&#39;Hiv&#39;</span><span class="p">]),</span>
                            <span class="n">topen</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">date</span> <span class="o">+</span> <span class="n">pd</span><span class="o">.</span><span class="n">DateOffset</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="n">days</span><span class="p">),</span>
                            <span class="n">tclose</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                            <span class="n">priority</span><span class="o">=</span><span class="mi">0</span>
                        <span class="p">)</span></div>

<div class="viewcode-block" id="NewbornOutcomes.assessment_and_initiation_of_neonatal_resus"><a class="viewcode-back" href="../../../reference/tlo.methods.newborn_outcomes.html#tlo.methods.newborn_outcomes.NewbornOutcomes.assessment_and_initiation_of_neonatal_resus">[docs]</a>    <span class="k">def</span> <span class="nf">assessment_and_initiation_of_neonatal_resus</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hsi_event</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This function manages the diagnosis of failure to transition/encephalopathy and the administration of neonatal</span>
<span class="sd">        resuscitation for neonates delivered in a facility. It is called by the HSI_NewbornOutcomes_CareOfTheNewborn</span>
<span class="sd">        BySkilledAttendant.</span>
<span class="sd">        :param hsi_event: The HSI event in which this function is called</span>
<span class="sd">        (HSI_NewbornOutcomes_CareOfTheNewbornBySkilledAttendant)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">population</span><span class="o">.</span><span class="n">props</span>
        <span class="n">person_id</span> <span class="o">=</span> <span class="n">hsi_event</span><span class="o">.</span><span class="n">target</span>

        <span class="k">if</span> <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">person_id</span><span class="p">,</span> <span class="s1">&#39;nb_not_breathing_at_birth&#39;</span><span class="p">]:</span>

            <span class="c1"># Required consumables are defined</span>
            <span class="n">avail</span> <span class="o">=</span> <span class="n">hsi_event</span><span class="o">.</span><span class="n">get_consumables</span><span class="p">(</span><span class="n">item_codes</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">item_codes_nb_consumables</span><span class="p">[</span><span class="s1">&#39;resuscitation&#39;</span><span class="p">])</span>

            <span class="c1"># Run HCW check</span>
            <span class="n">sf_check</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="s1">&#39;Labour&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">check_emonc_signal_function_will_run</span><span class="p">(</span>
                <span class="n">sf</span><span class="o">=</span><span class="s1">&#39;neo_resus&#39;</span><span class="p">,</span>  <span class="n">f_lvl</span><span class="o">=</span><span class="n">hsi_event</span><span class="o">.</span><span class="n">ACCEPTED_FACILITY_LEVEL</span><span class="p">)</span>

            <span class="c1"># Then, if the consumables are available,resuscitation is started. We assume this is delayed in</span>
            <span class="c1"># deliveries that are not attended</span>
            <span class="k">if</span> <span class="n">avail</span> <span class="ow">and</span> <span class="n">sf_check</span><span class="p">:</span>
                <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">person_id</span><span class="p">,</span> <span class="s1">&#39;nb_received_neonatal_resus&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">apply_risk_of_encephalopathy</span><span class="p">(</span><span class="n">person_id</span><span class="p">,</span> <span class="n">timing</span><span class="o">=</span><span class="s1">&#39;after_birth&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="NewbornOutcomes.assessment_and_treatment_newborn_sepsis"><a class="viewcode-back" href="../../../reference/tlo.methods.newborn_outcomes.html#tlo.methods.newborn_outcomes.NewbornOutcomes.assessment_and_treatment_newborn_sepsis">[docs]</a>    <span class="k">def</span> <span class="nf">assessment_and_treatment_newborn_sepsis</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hsi_event</span><span class="p">,</span> <span class="n">facility_type</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This function manages the treatment of early onset neonatal sepsis for neonates delivered in a facility.</span>
<span class="sd">         It is called by the</span>
<span class="sd">        HSI_NewbornOutcomes_CareOfTheNewbornBySkilledAttendant. Treatment for sepsis includes either injectable</span>
<span class="sd">         antibiotics or full supportive care (antibiotics, fluids, oxygen etc) and varies between facility level.</span>
<span class="sd">        :param hsi_event: The HSI event in which this function is called</span>
<span class="sd">        (HSI_NewbornOutcomes_CareOfTheNewbornBySkilledAttendant)</span>
<span class="sd">        :param facility_type: health centre (hc) or hospital (hp)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">population</span><span class="o">.</span><span class="n">props</span>
        <span class="n">person_id</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">hsi_event</span><span class="o">.</span><span class="n">target</span><span class="p">)</span>
        <span class="n">cons</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">item_codes_nb_consumables</span>

        <span class="c1"># We assume that only hospitals are able to deliver full supportive care for neonatal sepsis, full supportive</span>
        <span class="c1"># care evokes a stronger treatment effect than injectable antibiotics alone</span>

        <span class="k">if</span> <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">person_id</span><span class="p">,</span> <span class="s1">&#39;nb_early_onset_neonatal_sepsis&#39;</span><span class="p">]</span> <span class="ow">or</span> <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">person_id</span><span class="p">,</span> <span class="s1">&#39;pn_sepsis_late_neonatal&#39;</span><span class="p">]</span> <span class="ow">or</span>\
           <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">person_id</span><span class="p">,</span> <span class="s1">&#39;pn_sepsis_early_neonatal&#39;</span><span class="p">]:</span>

            <span class="k">if</span> <span class="n">facility_type</span> <span class="o">==</span> <span class="s1">&#39;hp&#39;</span><span class="p">:</span>
                <span class="n">avail</span> <span class="o">=</span> <span class="n">hsi_event</span><span class="o">.</span><span class="n">get_consumables</span><span class="p">(</span><span class="n">item_codes</span><span class="o">=</span><span class="n">cons</span><span class="p">[</span><span class="s1">&#39;sepsis_supportive_care&#39;</span><span class="p">],</span>
                                                  <span class="n">optional_item_codes</span><span class="o">=</span><span class="n">cons</span><span class="p">[</span><span class="s1">&#39;iv_drug_equipment&#39;</span><span class="p">])</span>

                <span class="c1"># Then, if the consumables are available, treatment for sepsis is delivered</span>
                <span class="k">if</span> <span class="n">avail</span><span class="p">:</span>
                    <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">person_id</span><span class="p">,</span> <span class="s1">&#39;nb_supp_care_neonatal_sepsis&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

            <span class="c1"># The same pattern is then followed for health centre care</span>
            <span class="k">elif</span> <span class="n">facility_type</span> <span class="o">==</span> <span class="s1">&#39;hc&#39;</span><span class="p">:</span>
                <span class="n">avail</span> <span class="o">=</span> <span class="n">hsi_event</span><span class="o">.</span><span class="n">get_consumables</span><span class="p">(</span><span class="n">item_codes</span><span class="o">=</span><span class="n">cons</span><span class="p">[</span><span class="s1">&#39;sepsis_abx&#39;</span><span class="p">],</span>
                                                  <span class="n">optional_item_codes</span><span class="o">=</span><span class="n">cons</span><span class="p">[</span><span class="s1">&#39;iv_drug_equipment&#39;</span><span class="p">])</span>

                <span class="k">if</span> <span class="n">avail</span><span class="p">:</span>
                    <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">person_id</span><span class="p">,</span> <span class="s1">&#39;nb_inj_abx_neonatal_sepsis&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="NewbornOutcomes.link_twins"><a class="viewcode-back" href="../../../reference/tlo.methods.newborn_outcomes.html#tlo.methods.newborn_outcomes.NewbornOutcomes.link_twins">[docs]</a>    <span class="k">def</span> <span class="nf">link_twins</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">child_one</span><span class="p">,</span> <span class="n">child_two</span><span class="p">,</span> <span class="n">mother_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This function links twin pairs via sibling IDs and is called by the BirthEvent in the Labour module</span>
<span class="sd">        :param child_one: individual_id of the first born child in a twin pair</span>
<span class="sd">        :param child_two: individual_id of the second born child in a twin pair</span>
<span class="sd">        :param mother_id: individual_id of the mother of the twin pair</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">population</span><span class="o">.</span><span class="n">props</span>

        <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">child_one</span><span class="p">,</span> <span class="s1">&#39;nb_twin_sibling_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">child_two</span>
        <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">child_two</span><span class="p">,</span> <span class="s1">&#39;nb_twin_sibling_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">child_one</span>
        <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">mother_id</span><span class="p">,</span> <span class="s1">&#39;ps_multiple_pregnancy&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="c1">#  log the twin pair</span>
        <span class="n">twin_birth</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;twin_1_id&#39;</span><span class="p">:</span> <span class="n">child_one</span><span class="p">,</span>
                      <span class="s1">&#39;twin_2_id&#39;</span><span class="p">:</span> <span class="n">child_two</span><span class="p">,</span>
                      <span class="s1">&#39;mother_id&#39;</span><span class="p">:</span> <span class="n">mother_id</span><span class="p">,</span>
                      <span class="s1">&#39;date_of_delivery&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">date</span><span class="p">}</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="s1">&#39;twin_birth&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">twin_birth</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;A record of each birth of twin pairs&#39;</span><span class="p">)</span>

        <span class="c1"># Finally we log the second live birth and add another to the womans parity</span>
        <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">mother_id</span><span class="p">,</span> <span class="s1">&#39;la_parity&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span></div>

<div class="viewcode-block" id="NewbornOutcomes.schedule_pnc"><a class="viewcode-back" href="../../../reference/tlo.methods.newborn_outcomes.html#tlo.methods.newborn_outcomes.NewbornOutcomes.schedule_pnc">[docs]</a>    <span class="k">def</span> <span class="nf">schedule_pnc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">child_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This function is called by the on_birth function for all newborns who will receive post natal care following</span>
<span class="sd">         birth. The function determines if PNC will be received early or let following birth and schedules</span>
<span class="sd">         HSI_NewbornOutcomes_ReceivesPostnatalCheck accordingly</span>
<span class="sd">        :param child_id: child&#39;s individual id</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_parameters</span>
        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">population</span><span class="o">.</span><span class="n">props</span>
        <span class="n">mother_id</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">child_id</span><span class="p">,</span> <span class="s1">&#39;mother_id&#39;</span><span class="p">]</span>
        <span class="n">m</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="s1">&#39;PregnancySupervisor&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mother_and_newborn_info</span><span class="p">[</span><span class="n">mother_id</span><span class="p">]</span>
        <span class="n">nci</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">newborn_care_info</span>

        <span class="c1"># Use a weighted random draw to determine when the HSI will occur</span>
        <span class="n">timing</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rng</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="s1">&#39;&lt;48&#39;</span><span class="p">,</span> <span class="s1">&#39;&gt;48&#39;</span><span class="p">],</span> <span class="n">p</span><span class="o">=</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;prob_timings_pnc_newborns&#39;</span><span class="p">])</span>

        <span class="c1"># If this is being called for the second of a twin pair, and the first twin is attending early, the second twin</span>
        <span class="c1"># will automatically attend early</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">timing</span> <span class="o">==</span> <span class="s1">&#39;&lt;48&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="s1">&#39;pnc_twin_one&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;early&#39;</span><span class="p">):</span>
            <span class="n">nci</span><span class="p">[</span><span class="n">child_id</span><span class="p">][</span><span class="s1">&#39;will_receive_pnc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;early&#39;</span>

            <span class="k">if</span> <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">mother_id</span><span class="p">,</span> <span class="s1">&#39;ps_multiple_pregnancy&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="s1">&#39;twin_count&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>
                <span class="n">m</span><span class="p">[</span><span class="s1">&#39;pnc_twin_one&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;early&#39;</span>

            <span class="n">early_event</span> <span class="o">=</span> <span class="n">HSI_NewbornOutcomes_ReceivesPostnatalCheck</span><span class="p">(</span><span class="n">module</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">person_id</span><span class="o">=</span><span class="n">child_id</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="s1">&#39;HealthSystem&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">schedule_hsi_event</span><span class="p">(</span>
                <span class="n">early_event</span><span class="p">,</span> <span class="n">priority</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                <span class="n">topen</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">date</span><span class="p">,</span>
                <span class="n">tclose</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">date</span> <span class="o">+</span> <span class="n">pd</span><span class="o">.</span><span class="n">DateOffset</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># &#39;Late&#39; PNC is scheduled in the postnatal supevervisor module</span>
            <span class="n">nci</span><span class="p">[</span><span class="n">child_id</span><span class="p">][</span><span class="s1">&#39;will_receive_pnc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;late&#39;</span></div>

<div class="viewcode-block" id="NewbornOutcomes.on_birth"><a class="viewcode-back" href="../../../reference/tlo.methods.newborn_outcomes.html#tlo.methods.newborn_outcomes.NewbornOutcomes.on_birth">[docs]</a>    <span class="k">def</span> <span class="nf">on_birth</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mother_id</span><span class="p">,</span> <span class="n">child_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;The on_birth function of this module sets key properties of all newborns, including prematurity</span>
<span class="sd">        status and schedules functions to set weight and size. For newborns delivered at home it determines if they will</span>
<span class="sd">        experience complications following birth (early onset sepsis, encephalopathy, failure to transition) and if</span>
<span class="sd">        these complications will lead to death or disability .For newborns delivered in facility it schedules</span>
<span class="sd">        HSI_NewbornOutcomes_CareOfTheNewbornBySkilledAttendant which represents the care newborns should receive</span>
<span class="sd">        after being delivered in a facility.</span>
<span class="sd">        :param mother_id: mother_id</span>
<span class="sd">        :param child_id: child_id</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">population</span><span class="o">.</span><span class="n">props</span>
        <span class="n">params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_parameters</span>
        <span class="n">nci</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">newborn_care_info</span>

        <span class="k">if</span> <span class="n">mother_id</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="c1"># The child has been born without a mother identified (from contraception.DirectBirth), so give the child</span>
            <span class="c1"># the default properties:</span>
            <span class="n">child</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;nb_is_twin&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                <span class="s1">&#39;nb_twin_sibling_id&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
                <span class="s1">&#39;nb_early_preterm&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                <span class="s1">&#39;nb_late_preterm&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                <span class="s1">&#39;nb_preterm_birth_disab&#39;</span><span class="p">:</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span>
                <span class="s1">&#39;nb_congenital_anomaly&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                <span class="s1">&#39;nb_early_onset_neonatal_sepsis&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                <span class="s1">&#39;nb_inj_abx_neonatal_sepsis&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                <span class="s1">&#39;nb_supp_care_neonatal_sepsis&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                <span class="s1">&#39;nb_neonatal_sepsis_disab&#39;</span><span class="p">:</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span>
                <span class="s1">&#39;nb_preterm_respiratory_distress&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                <span class="s1">&#39;nb_not_breathing_at_birth&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                <span class="s1">&#39;nb_received_neonatal_resus&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                <span class="s1">&#39;nb_encephalopathy&#39;</span><span class="p">:</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span>
                <span class="s1">&#39;nb_encephalopathy_disab&#39;</span><span class="p">:</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span>
                <span class="s1">&#39;nb_retinopathy_prem&#39;</span><span class="p">:</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span>
                <span class="s1">&#39;nb_low_birth_weight_status&#39;</span><span class="p">:</span> <span class="s1">&#39;normal_birth_weight&#39;</span><span class="p">,</span>
                <span class="s1">&#39;nb_size_for_gestational_age&#39;</span><span class="p">:</span> <span class="s1">&#39;average_for_gestational_age&#39;</span><span class="p">,</span>
                <span class="s1">&#39;nb_early_init_breastfeeding&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                <span class="s1">&#39;nb_breastfeeding_status&#39;</span><span class="p">:</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span>
                <span class="s1">&#39;nb_kangaroo_mother_care&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                <span class="s1">&#39;nb_clean_birth&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                <span class="s1">&#39;nb_received_cord_care&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                <span class="s1">&#39;nb_death_after_birth&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                <span class="s1">&#39;nb_pnc_check&#39;</span><span class="p">:</span> <span class="mi">0</span>
            <span class="p">}</span>
            <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">child_id</span><span class="p">,</span> <span class="n">child</span><span class="o">.</span><span class="n">keys</span><span class="p">()]</span> <span class="o">=</span> <span class="n">child</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
            <span class="k">return</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="s1">&#39;Labour&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">further_on_birth_labour</span><span class="p">(</span><span class="n">mother_id</span><span class="p">)</span>
        <span class="n">mni</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="s1">&#39;PregnancySupervisor&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mother_and_newborn_info</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">mni</span><span class="p">[</span><span class="n">mother_id</span><span class="p">]</span>

        <span class="c1"># For twins, each baby has the &#39;twin_count&#39; variable updated to ensure certain processes are/are not repeated</span>
        <span class="c1"># for each birth</span>
        <span class="k">if</span> <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">mother_id</span><span class="p">,</span> <span class="s1">&#39;ps_multiple_pregnancy&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">m</span><span class="p">[</span><span class="s1">&#39;twin_count&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">child_id</span><span class="p">,</span> <span class="s1">&#39;nb_is_twin&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">m</span><span class="p">[</span><span class="s1">&#39;twin_count&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">m</span><span class="p">[</span><span class="s1">&#39;single_twin_still_birth&#39;</span><span class="p">]:</span>
                <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">child_id</span><span class="p">,</span> <span class="s1">&#39;nb_twin_sibling_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>

        <span class="k">elif</span> <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">mother_id</span><span class="p">,</span> <span class="s1">&#39;ps_multiple_pregnancy&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="s1">&#39;twin_count&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">child_id</span><span class="p">,</span> <span class="s1">&#39;nb_is_twin&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">m</span><span class="p">[</span><span class="s1">&#39;twin_count&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>

        <span class="k">elif</span> <span class="ow">not</span> <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">mother_id</span><span class="p">,</span> <span class="s1">&#39;ps_multiple_pregnancy&#39;</span><span class="p">]:</span>
            <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">child_id</span><span class="p">,</span> <span class="s1">&#39;nb_is_twin&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">child_id</span><span class="p">,</span> <span class="s1">&#39;nb_twin_sibling_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>

        <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">child_id</span><span class="p">,</span> <span class="s1">&#39;nb_early_preterm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">child_id</span><span class="p">,</span> <span class="s1">&#39;nb_late_preterm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">child_id</span><span class="p">,</span> <span class="s1">&#39;nb_preterm_birth_disab&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span>
        <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">child_id</span><span class="p">,</span> <span class="s1">&#39;nb_congenital_anomaly&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">child_id</span><span class="p">,</span> <span class="s1">&#39;nb_early_onset_neonatal_sepsis&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">child_id</span><span class="p">,</span> <span class="s1">&#39;nb_inj_abx_neonatal_sepsis&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">child_id</span><span class="p">,</span> <span class="s1">&#39;nb_supp_care_neonatal_sepsis&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">child_id</span><span class="p">,</span> <span class="s1">&#39;nb_neonatal_sepsis_disab&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span>
        <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">child_id</span><span class="p">,</span> <span class="s1">&#39;nb_preterm_respiratory_distress&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">child_id</span><span class="p">,</span> <span class="s1">&#39;nb_not_breathing_at_birth&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">child_id</span><span class="p">,</span> <span class="s1">&#39;nb_received_neonatal_resus&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">child_id</span><span class="p">,</span> <span class="s1">&#39;nb_encephalopathy&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span>
        <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">child_id</span><span class="p">,</span> <span class="s1">&#39;nb_encephalopathy_disab&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span>
        <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">child_id</span><span class="p">,</span> <span class="s1">&#39;nb_retinopathy_prem&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span>

        <span class="c1"># Set the childs birthweight, decided in the labour module, and log accordingly</span>
        <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">child_id</span><span class="p">,</span> <span class="s1">&#39;nb_low_birth_weight_status&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mni</span><span class="p">[</span><span class="n">mother_id</span><span class="p">][</span><span class="s1">&#39;birth_weight&#39;</span><span class="p">]</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">child_id</span><span class="p">,</span> <span class="s1">&#39;nb_low_birth_weight_status&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;low_birth_weight&#39;</span><span class="p">)</span> <span class="ow">or</span>\
            <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">child_id</span><span class="p">,</span> <span class="s1">&#39;nb_low_birth_weight_status&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;very_low_birth_weight&#39;</span><span class="p">)</span> <span class="ow">or</span>\
           <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">child_id</span><span class="p">,</span> <span class="s1">&#39;nb_low_birth_weight_status&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;extremely_low_birth_weight&#39;</span><span class="p">):</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="s1">&#39;newborn_complication&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;newborn&#39;</span><span class="p">:</span> <span class="n">child_id</span><span class="p">,</span> <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;low_birth_weight&#39;</span><span class="p">})</span>

        <span class="k">elif</span> <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">child_id</span><span class="p">,</span> <span class="s1">&#39;nb_low_birth_weight_status&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;macrosomia&#39;</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="s1">&#39;newborn_complication&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;newborn&#39;</span><span class="p">:</span> <span class="n">child_id</span><span class="p">,</span> <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;macrosomia&#39;</span><span class="p">})</span>

        <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">child_id</span><span class="p">,</span> <span class="s1">&#39;nb_size_for_gestational_age&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mni</span><span class="p">[</span><span class="n">mother_id</span><span class="p">][</span><span class="s1">&#39;birth_size&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">child_id</span><span class="p">,</span> <span class="s1">&#39;nb_size_for_gestational_age&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;small_for_gestational_age&#39;</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="s1">&#39;newborn_complication&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;newborn&#39;</span><span class="p">:</span> <span class="n">child_id</span><span class="p">,</span> <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;small_for_gestational_age&#39;</span><span class="p">})</span>

        <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">child_id</span><span class="p">,</span> <span class="s1">&#39;nb_early_init_breastfeeding&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">child_id</span><span class="p">,</span> <span class="s1">&#39;nb_breastfeeding_status&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span>
        <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">child_id</span><span class="p">,</span> <span class="s1">&#39;nb_kangaroo_mother_care&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">child_id</span><span class="p">,</span> <span class="s1">&#39;nb_clean_birth&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">child_id</span><span class="p">,</span> <span class="s1">&#39;nb_received_cord_care&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">child_id</span><span class="p">,</span> <span class="s1">&#39;nb_death_after_birth&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">child_id</span><span class="p">,</span> <span class="s1">&#39;nb_pnc_check&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="c1"># &#39;Category&#39; of prematurity (early/late) is stored as a temporary property of the mother via the MNI dictionary</span>
        <span class="c1"># generated in labour (this is because some interventions delivered to the mother are based on prematurity)</span>

        <span class="c1"># We now store a newborns &#39;category of prematurity&#39; within the main data frame</span>
        <span class="k">if</span> <span class="n">m</span><span class="p">[</span><span class="s1">&#39;labour_state&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;early_preterm_labour&#39;</span><span class="p">:</span>
            <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">child_id</span><span class="p">,</span> <span class="s1">&#39;nb_early_preterm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">m</span><span class="p">[</span><span class="s1">&#39;labour_state&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;late_preterm_labour&#39;</span><span class="p">:</span>
            <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">child_id</span><span class="p">,</span> <span class="s1">&#39;nb_late_preterm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="c1"># Check no children born at term or postterm women are incorrectly categorised as preterm</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="s1">&#39;labour_state&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;term_labour&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="s1">&#39;labour_state&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;postterm_labour&#39;</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">child_id</span><span class="p">,</span> <span class="s1">&#39;nb_early_preterm&#39;</span><span class="p">]</span> <span class="ow">or</span> <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">child_id</span><span class="p">,</span> <span class="s1">&#39;nb_late_preterm&#39;</span><span class="p">]:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="s1">&#39;error&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Child </span><span class="si">{</span><span class="n">child_id</span><span class="si">}</span><span class="s1"> has been registered as preterm despite their mother &#39;</span>
                                               <span class="sa">f</span><span class="s1">&#39;delivering at term&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">child_id</span><span class="p">,</span> <span class="s1">&#39;is_alive&#39;</span><span class="p">]:</span>

            <span class="c1">#  Next we populate the newborn info dictionary with relevant parameters</span>
            <span class="n">nci</span><span class="p">[</span><span class="n">child_id</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;ga_at_birth&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">mother_id</span><span class="p">,</span> <span class="s1">&#39;ps_gestational_age_in_weeks&#39;</span><span class="p">]),</span>
                             <span class="s1">&#39;maternal_chorio&#39;</span><span class="p">:</span> <span class="n">mni</span><span class="p">[</span><span class="n">mother_id</span><span class="p">][</span><span class="s1">&#39;chorio_in_preg&#39;</span><span class="p">],</span>
                             <span class="s1">&#39;maternal_gest_diab&#39;</span><span class="p">:</span> <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">mother_id</span><span class="p">,</span> <span class="s1">&#39;ps_gest_diab&#39;</span><span class="p">],</span>
                             <span class="s1">&#39;vit_k&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                             <span class="s1">&#39;tetra_eye_d&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                             <span class="s1">&#39;proph_abx&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                             <span class="s1">&#39;abx_for_prom_given&#39;</span><span class="p">:</span> <span class="n">mni</span><span class="p">[</span><span class="n">mother_id</span><span class="p">][</span><span class="s1">&#39;abx_for_prom_given&#39;</span><span class="p">],</span>
                             <span class="s1">&#39;corticosteroids_given&#39;</span><span class="p">:</span> <span class="n">mni</span><span class="p">[</span><span class="n">mother_id</span><span class="p">][</span><span class="s1">&#39;corticosteroids_given&#39;</span><span class="p">],</span>
                             <span class="s1">&#39;delivery_setting&#39;</span><span class="p">:</span> <span class="n">mni</span><span class="p">[</span><span class="n">mother_id</span><span class="p">][</span><span class="s1">&#39;delivery_setting&#39;</span><span class="p">],</span>
                             <span class="s1">&#39;cause_of_death_after_birth&#39;</span><span class="p">:</span> <span class="p">[],</span>
                             <span class="s1">&#39;sepsis_postnatal&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                             <span class="s1">&#39;passed_through_week_one&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                             <span class="s1">&#39;will_receive_pnc&#39;</span><span class="p">:</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span>
                             <span class="s1">&#39;third_delay&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">}</span>

            <span class="k">if</span> <span class="n">mni</span><span class="p">[</span><span class="n">mother_id</span><span class="p">][</span><span class="s1">&#39;clean_birth_practices&#39;</span><span class="p">]:</span>
                <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">child_id</span><span class="p">,</span> <span class="s1">&#39;nb_clean_birth&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

            <span class="c1"># Check these variables are not unassigned</span>
            <span class="k">if</span> <span class="n">nci</span><span class="p">[</span><span class="n">child_id</span><span class="p">][</span><span class="s1">&#39;delivery_setting&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;none&#39;</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="s1">&#39;error&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Child </span><span class="si">{</span><span class="n">child_id</span><span class="si">}</span><span class="s1"> does not have a delivery setting stored&#39;</span><span class="p">)</span>

            <span class="c1"># --------------------------------------- Breastfeeding -------------------------------------------------</span>
            <span class="c1"># Check see if this newborn will start breastfeeding</span>
            <span class="k">if</span> <span class="n">m</span><span class="p">[</span><span class="s1">&#39;delivery_setting&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;home_birth&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">breast_feeding</span><span class="p">(</span><span class="n">child_id</span><span class="p">,</span> <span class="n">birth_setting</span><span class="o">=</span><span class="s1">&#39;hb&#39;</span><span class="p">)</span>  <span class="c1"># hb = home birth</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">breast_feeding</span><span class="p">(</span><span class="n">child_id</span><span class="p">,</span> <span class="n">birth_setting</span><span class="o">=</span><span class="s1">&#39;hf&#39;</span><span class="p">)</span>  <span class="c1"># hf = health facility</span>

            <span class="c1"># ====================================== COMPLICATIONS ====================================================</span>
            <span class="c1"># Here we apply risk of complications following birth -first we determine if this child has been born with</span>
            <span class="c1"># a congenital anomaly</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">apply_risk_of_congenital_anomaly</span><span class="p">(</span><span class="n">child_id</span><span class="p">)</span>

            <span class="c1"># Next, for all preterm newborns we apply a risk of retinopathy of prematurity</span>
            <span class="k">if</span> <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">child_id</span><span class="p">,</span> <span class="s1">&#39;nb_early_preterm&#39;</span><span class="p">]</span> <span class="ow">or</span> <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">child_id</span><span class="p">,</span> <span class="s1">&#39;nb_late_preterm&#39;</span><span class="p">]:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rng</span><span class="o">.</span><span class="n">random_sample</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;prob_retinopathy_preterm&#39;</span><span class="p">]:</span>

                    <span class="c1"># For newborns with retinopathy we then use a weighted random draw to determine the severity of the</span>
                    <span class="c1"># retinopathy to map to DALY weights</span>
                    <span class="n">random_draw</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rng</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="s1">&#39;mild&#39;</span><span class="p">,</span> <span class="s1">&#39;moderate&#39;</span><span class="p">,</span> <span class="s1">&#39;severe&#39;</span><span class="p">,</span> <span class="s1">&#39;blindness&#39;</span><span class="p">],</span>
                                                  <span class="n">p</span><span class="o">=</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;prob_retinopathy_severity&#39;</span><span class="p">])</span>

                    <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">child_id</span><span class="p">,</span> <span class="s1">&#39;nb_retinopathy_prem&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">random_draw</span>

                <span class="c1"># and respiratory distress syndrome</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">apply_risk_of_preterm_respiratory_distress_syndrome</span><span class="p">(</span><span class="n">child_id</span><span class="p">)</span>

            <span class="c1"># Finally apply risk of infect, encephalopathy and respiratory depression</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">apply_risk_of_neonatal_infection_and_sepsis</span><span class="p">(</span><span class="n">child_id</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">apply_risk_of_encephalopathy</span><span class="p">(</span><span class="n">child_id</span><span class="p">,</span> <span class="n">timing</span><span class="o">=</span><span class="s1">&#39;on_birth&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">apply_risk_of_not_breathing_at_birth</span><span class="p">(</span><span class="n">child_id</span><span class="p">)</span>

            <span class="c1"># Neonates who were delivered in a facility are automatically scheduled to receive care at birth at the</span>
            <span class="c1"># same level of facility that they were delivered in</span>

            <span class="c1"># ===================================== HSI SCHEDULING ====================================================</span>
            <span class="c1"># If delivered in a health facility schedule immediate post-delivery care</span>
            <span class="k">if</span> <span class="n">m</span><span class="p">[</span><span class="s1">&#39;delivery_setting&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;home_birth&#39;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">m</span><span class="p">[</span><span class="s1">&#39;delivery_setting&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;health_centre&#39;</span><span class="p">:</span>
                    <span class="n">f_level</span> <span class="o">=</span> <span class="s1">&#39;1a&#39;</span>
                <span class="k">elif</span> <span class="n">m</span><span class="p">[</span><span class="s1">&#39;delivery_setting&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;hospital&#39;</span><span class="p">:</span>
                    <span class="n">f_level</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rng</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="s1">&#39;1a&#39;</span><span class="p">,</span> <span class="s1">&#39;1b&#39;</span><span class="p">])</span>

                <span class="n">event</span> <span class="o">=</span> <span class="n">HSI_NewbornOutcomes_CareOfTheNewbornBySkilledAttendantAtBirth</span><span class="p">(</span>
                    <span class="bp">self</span><span class="p">,</span> <span class="n">person_id</span><span class="o">=</span><span class="n">child_id</span><span class="p">,</span> <span class="n">facility_level_of_this_hsi</span><span class="o">=</span><span class="n">f_level</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="s1">&#39;HealthSystem&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">schedule_hsi_event</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">priority</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                                                                    <span class="n">topen</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">date</span><span class="p">,</span>
                                                                    <span class="n">tclose</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">date</span> <span class="o">+</span> <span class="n">DateOffset</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>

                <span class="c1"># Followed by a full postnatal check up</span>
                <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rng</span><span class="o">.</span><span class="n">random_sample</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;prob_pnc_check_newborn&#39;</span><span class="p">])</span> <span class="ow">or</span> <span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="s1">&#39;pnc_twin_one&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;none&#39;</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">schedule_pnc</span><span class="p">(</span><span class="n">child_id</span><span class="p">)</span>

            <span class="c1"># If delivered at home, determine if a postnatal check will be sought for this newborn- with the probability</span>
            <span class="c1"># being higher if complications have occurred</span>
            <span class="k">elif</span> <span class="n">m</span><span class="p">[</span><span class="s1">&#39;delivery_setting&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;home_birth&#39;</span><span class="p">:</span>

                <span class="k">if</span> <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">child_id</span><span class="p">,</span> <span class="s1">&#39;nb_early_onset_neonatal_sepsis&#39;</span><span class="p">]</span> <span class="ow">or</span> \
                    <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">child_id</span><span class="p">,</span> <span class="s1">&#39;nb_encephalopathy&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;none&#39;</span><span class="p">)</span> <span class="ow">or</span> \
                    <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">child_id</span><span class="p">,</span> <span class="s1">&#39;nb_early_preterm&#39;</span><span class="p">]</span> <span class="ow">or</span> \
                   <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">child_id</span><span class="p">,</span> <span class="s1">&#39;nb_late_preterm&#39;</span><span class="p">]:</span>

                    <span class="n">care_seeking</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;prob_care_seeking_for_complication&#39;</span><span class="p">]</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="n">care_seeking</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;prob_pnc_check_newborn&#39;</span><span class="p">]</span>

                <span class="c1"># If indicated we schedule either and early or late PNC visit for this individual</span>
                <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rng</span><span class="o">.</span><span class="n">random_sample</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">care_seeking</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="s1">&#39;pnc_twin_one&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;none&#39;</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">schedule_pnc</span><span class="p">(</span><span class="n">child_id</span><span class="p">)</span>

                <span class="c1"># If this child will not receive any early care following delivery we determine if they will die</span>
                <span class="c1"># following any complications immediately after birth</span>
                <span class="k">if</span> <span class="n">nci</span><span class="p">[</span><span class="n">child_id</span><span class="p">][</span><span class="s1">&#39;will_receive_pnc&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;early&#39;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">set_death_status</span><span class="p">(</span><span class="n">child_id</span><span class="p">)</span>

        <span class="c1"># Finally we call the following functions to conduct logging/update variables related to pregnancy</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">mother_id</span><span class="p">,</span> <span class="s1">&#39;ps_multiple_pregnancy&#39;</span><span class="p">]</span> <span class="ow">or</span>\
            <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">mother_id</span><span class="p">,</span> <span class="s1">&#39;ps_multiple_pregnancy&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="s1">&#39;twin_count&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span><span class="p">))</span> <span class="ow">or</span> \
           <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">mother_id</span><span class="p">,</span> <span class="s1">&#39;ps_multiple_pregnancy&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">m</span><span class="p">[</span><span class="s1">&#39;single_twin_still_birth&#39;</span><span class="p">]):</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="s1">&#39;PregnancySupervisor&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">further_on_birth_pregnancy_supervisor</span><span class="p">(</span><span class="n">mother_id</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="s1">&#39;PostnatalSupervisor&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">further_on_birth_postnatal_supervisor</span><span class="p">(</span><span class="n">mother_id</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="s1">&#39;CareOfWomenDuringPregnancy&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">further_on_birth_care_of_women_in_pregnancy</span><span class="p">(</span><span class="n">mother_id</span><span class="p">)</span></div>

<div class="viewcode-block" id="NewbornOutcomes.on_hsi_alert"><a class="viewcode-back" href="../../../reference/tlo.methods.newborn_outcomes.html#tlo.methods.newborn_outcomes.NewbornOutcomes.on_hsi_alert">[docs]</a>    <span class="k">def</span> <span class="nf">on_hsi_alert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">person_id</span><span class="p">,</span> <span class="n">treatment_id</span><span class="p">):</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="s1">&#39;message&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;This is NewbornOutcomes, being alerted about a health system interaction &#39;</span>
                                         <span class="sa">f</span><span class="s1">&#39;person </span><span class="si">{</span><span class="n">person_id</span><span class="si">}</span><span class="s1"> for: </span><span class="si">{</span><span class="n">treatment_id</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="NewbornOutcomes.report_daly_values"><a class="viewcode-back" href="../../../reference/tlo.methods.newborn_outcomes.html#tlo.methods.newborn_outcomes.NewbornOutcomes.report_daly_values">[docs]</a>    <span class="k">def</span> <span class="nf">report_daly_values</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This function reports the DALY weights for this module generated in the previous month</span>
<span class="sd">        :return: data frame containing the DALY weights</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="s1">&#39;message&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="s1">&#39;This is Newborn Outcomes reporting my health values&#39;</span><span class="p">)</span>

        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">population</span><span class="o">.</span><span class="n">props</span>
        <span class="n">p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;nb_daly_weights&#39;</span><span class="p">]</span>

        <span class="c1"># Disability properties are mapped to DALY weights and stored for the health burden module</span>
        <span class="n">health_values_1</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">is_alive</span><span class="p">,</span> <span class="s1">&#39;nb_retinopathy_prem&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span>
                    <span class="p">{</span><span class="s1">&#39;none&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;mild&#39;</span><span class="p">:</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;mild_vision_rptb&#39;</span><span class="p">],</span> <span class="s1">&#39;moderate&#39;</span><span class="p">:</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;moderate_vision_rptb&#39;</span><span class="p">],</span>
                     <span class="s1">&#39;severe&#39;</span><span class="p">:</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;severe_vision_rptb&#39;</span><span class="p">],</span> <span class="s1">&#39;blindness&#39;</span><span class="p">:</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;blindness_rptb&#39;</span><span class="p">]})</span>
        <span class="n">health_values_1</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Retinopathy of Prematurity&#39;</span>
        <span class="n">health_values_1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">health_values_1</span><span class="p">)</span>

        <span class="n">health_values_2</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">is_alive</span><span class="p">,</span> <span class="s1">&#39;nb_encephalopathy_disab&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span>
            <span class="p">{</span><span class="s1">&#39;none&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;mild_motor&#39;</span><span class="p">:</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;mild_motor_enceph&#39;</span><span class="p">],</span> <span class="s1">&#39;mild_motor_and_cog&#39;</span><span class="p">:</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;mild_motor_cognitive_enceph&#39;</span><span class="p">],</span>
             <span class="s1">&#39;moderate_motor&#39;</span><span class="p">:</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;moderate_motor_enceph&#39;</span><span class="p">],</span> <span class="s1">&#39;severe_motor&#39;</span><span class="p">:</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;severe_motor_enceph&#39;</span><span class="p">]})</span>
        <span class="n">health_values_2</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Neonatal Encephalopathy&#39;</span>
        <span class="n">health_values_2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">health_values_2</span><span class="p">)</span>

        <span class="n">health_values_3</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">is_alive</span><span class="p">,</span> <span class="s1">&#39;nb_neonatal_sepsis_disab&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span>
            <span class="p">{</span><span class="s1">&#39;none&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;mild_motor&#39;</span><span class="p">:</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;mild_motor_sepsis&#39;</span><span class="p">],</span> <span class="s1">&#39;mild_motor_and_cog&#39;</span><span class="p">:</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;mild_motor_cognitive_sepsis&#39;</span><span class="p">],</span>
             <span class="s1">&#39;moderate_motor&#39;</span><span class="p">:</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;moderate_motor_sepsis&#39;</span><span class="p">],</span> <span class="s1">&#39;severe_motor&#39;</span><span class="p">:</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;severe_motor_sepsis&#39;</span><span class="p">]})</span>
        <span class="n">health_values_3</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Neonatal Sepsis Long term Disability&#39;</span>
        <span class="n">health_values_3</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">health_values_3</span><span class="p">)</span>

        <span class="n">health_values_4</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">is_alive</span><span class="p">,</span> <span class="s1">&#39;nb_preterm_birth_disab&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span>
            <span class="p">{</span><span class="s1">&#39;none&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;mild_motor&#39;</span><span class="p">:</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;mild_motor_preterm&#39;</span><span class="p">],</span> <span class="s1">&#39;mild_motor_and_cog&#39;</span><span class="p">:</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;mild_motor_cognitive_preterm&#39;</span><span class="p">],</span>
             <span class="s1">&#39;moderate_motor&#39;</span><span class="p">:</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;moderate_motor_preterm&#39;</span><span class="p">],</span> <span class="s1">&#39;severe_motor&#39;</span><span class="p">:</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;severe_motor_preterm&#39;</span><span class="p">]})</span>
        <span class="n">health_values_4</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Preterm Birth Disability&#39;</span>
        <span class="n">health_values_4</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">health_values_4</span><span class="p">)</span>

        <span class="n">health_values_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">health_values_1</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">is_alive</span><span class="p">],</span> <span class="n">health_values_2</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">is_alive</span><span class="p">],</span>
                                     <span class="n">health_values_3</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">is_alive</span><span class="p">],</span> <span class="n">health_values_4</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">is_alive</span><span class="p">]],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="n">scaling_factor</span> <span class="o">=</span> <span class="p">(</span><span class="n">health_values_df</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">lower</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">upper</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">/</span>
                          <span class="n">health_values_df</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>

        <span class="n">health_values_df</span> <span class="o">=</span> <span class="n">health_values_df</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">scaling_factor</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">health_values_df</span></div>

<div class="viewcode-block" id="NewbornOutcomes.run_if_care_of_the_newborn_by_skilled_attendant_at_birth_cant_run"><a class="viewcode-back" href="../../../reference/tlo.methods.newborn_outcomes.html#tlo.methods.newborn_outcomes.NewbornOutcomes.run_if_care_of_the_newborn_by_skilled_attendant_at_birth_cant_run">[docs]</a>    <span class="k">def</span> <span class="nf">run_if_care_of_the_newborn_by_skilled_attendant_at_birth_cant_run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hsi_event</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This function is called by HSI_NewbornOutcomes_CareOfTheNewbornBySkilledAttendantAtBirth if the HSI is unable to</span>
<span class="sd">        run on the date it has been scheduled for. Risk of death is applied to newborns as this would have been applied</span>
<span class="sd">         within the event</span>
<span class="sd">        :param hsi_event: HSI event in which the function has been called:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">person_id</span> <span class="o">=</span> <span class="n">hsi_event</span><span class="o">.</span><span class="n">target</span>
        <span class="n">nci</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">newborn_care_info</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="s1">&#39;message&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;NewbornOutcomes_CareOfTheNewbornBySkilledAttendant did not run for &#39;</span>
                                         <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">person_id</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">nci</span><span class="p">[</span><span class="n">person_id</span><span class="p">][</span><span class="s1">&#39;will_receive_pnc&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;early&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_death_status</span><span class="p">(</span><span class="n">person_id</span><span class="p">)</span></div>

<div class="viewcode-block" id="NewbornOutcomes.run_if_care_of_the_receives_postnatal_check_cant_run"><a class="viewcode-back" href="../../../reference/tlo.methods.newborn_outcomes.html#tlo.methods.newborn_outcomes.NewbornOutcomes.run_if_care_of_the_receives_postnatal_check_cant_run">[docs]</a>    <span class="k">def</span> <span class="nf">run_if_care_of_the_receives_postnatal_check_cant_run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hsi_event</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This function is called by HSI_NewbornOutcomes_ReceivesPostnatalCheck if the HSI is unable to</span>
<span class="sd">        run on the date it has been scheduled for. Risk of death is applied to newborns as this would have been applied</span>
<span class="sd">        within the event</span>
<span class="sd">        :param hsi_event: HSI event in which the function has been called:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">person_id</span> <span class="o">=</span> <span class="n">hsi_event</span><span class="o">.</span><span class="n">target</span>
        <span class="n">nci</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">newborn_care_info</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="s1">&#39;message&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;HSI_NewbornOutcomes_ReceivesPostnatalCheck did not run for &#39;</span>
                                         <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">person_id</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">person_id</span> <span class="ow">in</span> <span class="n">nci</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_death_status</span><span class="p">(</span><span class="n">person_id</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="HSI_NewbornOutcomes_CareOfTheNewbornBySkilledAttendantAtBirth"><a class="viewcode-back" href="../../../reference/tlo.methods.newborn_outcomes.html#tlo.methods.newborn_outcomes.HSI_NewbornOutcomes_CareOfTheNewbornBySkilledAttendantAtBirth">[docs]</a><span class="k">class</span> <span class="nc">HSI_NewbornOutcomes_CareOfTheNewbornBySkilledAttendantAtBirth</span><span class="p">(</span><span class="n">HSI_Event</span><span class="p">,</span> <span class="n">IndividualScopeEventMixin</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This is HSI_NewbornOutcomes_CareOfTheNewbornBySkilledAttendantAtBirth. It is scheduled by on_birth for any newborns</span>
<span class="sd">    who were delivered in a health facility. Currently it applies the effect of interventions that would reasonably be</span>
<span class="sd">    delivered as part of the process of birth (i.e. resuscitation of a flat newborn) but is not a full postnatal</span>
<span class="sd">    check</span>
<span class="sd">    &quot;&quot;&quot;</span>
<div class="viewcode-block" id="HSI_NewbornOutcomes_CareOfTheNewbornBySkilledAttendantAtBirth.__init__"><a class="viewcode-back" href="../../../reference/tlo.methods.newborn_outcomes.html#tlo.methods.newborn_outcomes.HSI_NewbornOutcomes_CareOfTheNewbornBySkilledAttendantAtBirth.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">person_id</span><span class="p">,</span> <span class="n">facility_level_of_this_hsi</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">person_id</span><span class="o">=</span><span class="n">person_id</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">NewbornOutcomes</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">TREATMENT_ID</span> <span class="o">=</span> <span class="s1">&#39;DeliveryCare_Neonatal&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">EXPECTED_APPT_FOOTPRINT</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_appt_footprint</span><span class="p">({})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ACCEPTED_FACILITY_LEVEL</span> <span class="o">=</span> <span class="n">facility_level_of_this_hsi</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">BEDDAYS_FOOTPRINT</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_beddays_footprint</span><span class="p">({</span><span class="s1">&#39;general_bed&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span></div>

<div class="viewcode-block" id="HSI_NewbornOutcomes_CareOfTheNewbornBySkilledAttendantAtBirth.apply"><a class="viewcode-back" href="../../../reference/tlo.methods.newborn_outcomes.html#tlo.methods.newborn_outcomes.HSI_NewbornOutcomes_CareOfTheNewbornBySkilledAttendantAtBirth.apply">[docs]</a>    <span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">person_id</span><span class="p">,</span> <span class="n">squeeze_factor</span><span class="p">):</span>
        <span class="n">nci</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="o">.</span><span class="n">newborn_care_info</span>
        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">population</span><span class="o">.</span><span class="n">props</span>
        <span class="n">params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="o">.</span><span class="n">current_parameters</span>

        <span class="c1"># Run some checks on the individual</span>
        <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">date</span> <span class="o">==</span> <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">person_id</span><span class="p">,</span> <span class="s1">&#39;date_of_birth&#39;</span><span class="p">]</span> <span class="ow">or</span>
           <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">person_id</span><span class="p">,</span> <span class="s1">&#39;nb_death_after_birth&#39;</span><span class="p">]</span> <span class="ow">or</span>
           <span class="n">nci</span><span class="p">[</span><span class="n">person_id</span><span class="p">][</span><span class="s1">&#39;delivery_setting&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;home_birth&#39;</span><span class="p">):</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="s1">&#39;error&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Child </span><span class="si">{</span><span class="n">person_id</span><span class="si">}</span><span class="s1"> arrived at CareOfTheNewbornBySkilledAttendantAtBirth &#39;</span>
                                           <span class="sa">f</span><span class="s1">&#39;when they shouldnt have&#39;</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">person_id</span><span class="p">,</span> <span class="s1">&#39;is_alive&#39;</span><span class="p">]:</span>
            <span class="k">return</span>

        <span class="c1"># Check for delay due to high squeeze</span>
        <span class="k">if</span> <span class="n">squeeze_factor</span> <span class="o">&gt;</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;squeeze_threshold_for_delay_three_nb_care&#39;</span><span class="p">]:</span>
            <span class="n">nci</span><span class="p">[</span><span class="n">person_id</span><span class="p">][</span><span class="s1">&#39;third_delay&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="o">.</span><span class="n">assessment_and_initiation_of_neonatal_resus</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">nci</span><span class="p">[</span><span class="n">person_id</span><span class="p">][</span><span class="s1">&#39;will_receive_pnc&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;early&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="o">.</span><span class="n">set_death_status</span><span class="p">(</span><span class="n">person_id</span><span class="p">)</span></div>

<div class="viewcode-block" id="HSI_NewbornOutcomes_CareOfTheNewbornBySkilledAttendantAtBirth.never_ran"><a class="viewcode-back" href="../../../reference/tlo.methods.newborn_outcomes.html#tlo.methods.newborn_outcomes.HSI_NewbornOutcomes_CareOfTheNewbornBySkilledAttendantAtBirth.never_ran">[docs]</a>    <span class="k">def</span> <span class="nf">never_ran</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="o">.</span><span class="n">run_if_care_of_the_newborn_by_skilled_attendant_at_birth_cant_run</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="HSI_NewbornOutcomes_CareOfTheNewbornBySkilledAttendantAtBirth.did_not_run"><a class="viewcode-back" href="../../../reference/tlo.methods.newborn_outcomes.html#tlo.methods.newborn_outcomes.HSI_NewbornOutcomes_CareOfTheNewbornBySkilledAttendantAtBirth.did_not_run">[docs]</a>    <span class="k">def</span> <span class="nf">did_not_run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="o">.</span><span class="n">run_if_care_of_the_newborn_by_skilled_attendant_at_birth_cant_run</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="HSI_NewbornOutcomes_CareOfTheNewbornBySkilledAttendantAtBirth.not_available"><a class="viewcode-back" href="../../../reference/tlo.methods.newborn_outcomes.html#tlo.methods.newborn_outcomes.HSI_NewbornOutcomes_CareOfTheNewbornBySkilledAttendantAtBirth.not_available">[docs]</a>    <span class="k">def</span> <span class="nf">not_available</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="o">.</span><span class="n">run_if_care_of_the_newborn_by_skilled_attendant_at_birth_cant_run</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="HSI_NewbornOutcomes_ReceivesPostnatalCheck"><a class="viewcode-back" href="../../../reference/tlo.methods.newborn_outcomes.html#tlo.methods.newborn_outcomes.HSI_NewbornOutcomes_ReceivesPostnatalCheck">[docs]</a><span class="k">class</span> <span class="nc">HSI_NewbornOutcomes_ReceivesPostnatalCheck</span><span class="p">(</span><span class="n">HSI_Event</span><span class="p">,</span> <span class="n">IndividualScopeEventMixin</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This is HSI_NewbornOutcomes_ReceivesEarlyPostnatalCheck. This event is scheduled on_birth for all neonates who are</span>
<span class="sd">    predicted to receive a full postnatal checkup within the first 2 days of life following either home birth or</span>
<span class="sd">    facility delivery. Interventions within in this event include management of essential newborn care, initiation of</span>
<span class="sd">    kangaroo mother care, newborn immunisation, HIV screening and management of early onset neonatal sepsis,</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="HSI_NewbornOutcomes_ReceivesPostnatalCheck.__init__"><a class="viewcode-back" href="../../../reference/tlo.methods.newborn_outcomes.html#tlo.methods.newborn_outcomes.HSI_NewbornOutcomes_ReceivesPostnatalCheck.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">person_id</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">person_id</span><span class="o">=</span><span class="n">person_id</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">NewbornOutcomes</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">TREATMENT_ID</span> <span class="o">=</span> <span class="s1">&#39;PostnatalCare_Neonatal&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">EXPECTED_APPT_FOOTPRINT</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_appt_footprint</span><span class="p">({</span><span class="s1">&#39;Under5OPD&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ACCEPTED_FACILITY_LEVEL</span> <span class="o">=</span> <span class="s1">&#39;1a&#39;</span></div>

<div class="viewcode-block" id="HSI_NewbornOutcomes_ReceivesPostnatalCheck.apply"><a class="viewcode-back" href="../../../reference/tlo.methods.newborn_outcomes.html#tlo.methods.newborn_outcomes.HSI_NewbornOutcomes_ReceivesPostnatalCheck.apply">[docs]</a>    <span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">person_id</span><span class="p">,</span> <span class="n">squeeze_factor</span><span class="p">):</span>
        <span class="n">nci</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="o">.</span><span class="n">newborn_care_info</span>
        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">population</span><span class="o">.</span><span class="n">props</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">person_id</span><span class="p">,</span> <span class="s1">&#39;is_alive&#39;</span><span class="p">]</span> <span class="ow">or</span> <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">person_id</span><span class="p">,</span> <span class="s1">&#39;nb_death_after_birth&#39;</span><span class="p">]</span> <span class="ow">or</span> <span class="p">(</span><span class="n">person_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">nci</span><span class="p">):</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">nci</span><span class="p">[</span><span class="n">person_id</span><span class="p">][</span><span class="s1">&#39;will_receive_pnc&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;early&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">nci</span><span class="p">[</span><span class="n">person_id</span><span class="p">][</span><span class="s1">&#39;passed_through_week_one&#39;</span><span class="p">]:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">date</span> <span class="o">&lt;</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">person_id</span><span class="p">,</span> <span class="s1">&#39;date_of_birth&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">pd</span><span class="o">.</span><span class="n">DateOffset</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">2</span><span class="p">)):</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="s1">&#39;error&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Child </span><span class="si">{</span><span class="n">person_id</span><span class="si">}</span><span class="s1"> arrived at early PNC too late&#39;</span><span class="p">)</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">person_id</span><span class="p">,</span> <span class="s1">&#39;nb_pnc_check&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="s1">&#39;error&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Child </span><span class="si">{</span><span class="n">person_id</span><span class="si">}</span><span class="s1"> arrived at early PNC twice&#39;</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">nci</span><span class="p">[</span><span class="n">person_id</span><span class="p">][</span><span class="s1">&#39;will_receive_pnc&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;late&#39;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">nci</span><span class="p">[</span><span class="n">person_id</span><span class="p">][</span><span class="s1">&#39;passed_through_week_one&#39;</span><span class="p">]:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">date</span> <span class="o">&gt;=</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">person_id</span><span class="p">,</span> <span class="s1">&#39;date_of_birth&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">pd</span><span class="o">.</span><span class="n">DateOffset</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">2</span><span class="p">)):</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="s1">&#39;error&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Child </span><span class="si">{</span><span class="n">person_id</span><span class="si">}</span><span class="s1"> arrived at late PNC too early&#39;</span><span class="p">)</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">person_id</span><span class="p">,</span> <span class="s1">&#39;nb_pnc_check&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="s1">&#39;error&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Child </span><span class="si">{</span><span class="n">person_id</span><span class="si">}</span><span class="s1"> arrived at late PNC twice&#39;</span><span class="p">)</span>

        <span class="c1"># Log the PNC check</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="s1">&#39;postnatal_check&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;person_id&#39;</span><span class="p">:</span> <span class="n">person_id</span><span class="p">,</span>
                                                 <span class="s1">&#39;delivery_setting&#39;</span><span class="p">:</span> <span class="n">nci</span><span class="p">[</span><span class="n">person_id</span><span class="p">][</span><span class="s1">&#39;delivery_setting&#39;</span><span class="p">],</span>
                                                 <span class="s1">&#39;visit_number&#39;</span><span class="p">:</span> <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">person_id</span><span class="p">,</span> <span class="s1">&#39;nb_pnc_check&#39;</span><span class="p">],</span>
                                                 <span class="s1">&#39;timing&#39;</span><span class="p">:</span> <span class="n">nci</span><span class="p">[</span><span class="n">person_id</span><span class="p">][</span><span class="s1">&#39;will_receive_pnc&#39;</span><span class="p">]})</span>

        <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">person_id</span><span class="p">,</span> <span class="s1">&#39;nb_pnc_check&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="c1"># This HSI contains the interventions delivered as part of a full postnatal check of the newborn after birth -</span>
        <span class="c1"># this include newborns who delivered at home or in facility</span>
        <span class="k">if</span> <span class="n">nci</span><span class="p">[</span><span class="n">person_id</span><span class="p">][</span><span class="s1">&#39;delivery_setting&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;health_centre&#39;</span><span class="p">:</span>
            <span class="n">facility_type_code</span> <span class="o">=</span> <span class="s1">&#39;hc&#39;</span>
        <span class="k">elif</span> <span class="n">nci</span><span class="p">[</span><span class="n">person_id</span><span class="p">][</span><span class="s1">&#39;delivery_setting&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;hospital&#39;</span><span class="p">:</span>
            <span class="n">facility_type_code</span> <span class="o">=</span> <span class="s1">&#39;hp&#39;</span>
        <span class="k">elif</span> <span class="n">nci</span><span class="p">[</span><span class="n">person_id</span><span class="p">][</span><span class="s1">&#39;delivery_setting&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;home_birth&#39;</span><span class="p">:</span>
            <span class="n">facility_type_code</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="o">.</span><span class="n">rng</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="s1">&#39;hc&#39;</span><span class="p">,</span> <span class="s1">&#39;hp&#39;</span><span class="p">])</span>

        <span class="c1"># First the newborn is assessed for sepsis and treated if needed</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="o">.</span><span class="n">assessment_and_treatment_newborn_sepsis</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">facility_type_code</span><span class="p">)</span>

        <span class="c1"># Next, interventions pertaining to essential newborn care</span>
        <span class="k">if</span> <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">person_id</span><span class="p">,</span> <span class="s1">&#39;nb_pnc_check&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="o">.</span><span class="n">essential_newborn_care</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

            <span class="c1"># ...and invitation of kangaroo mother care for small infants</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="o">.</span><span class="n">kangaroo_mother_care</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

            <span class="c1"># Finally these newborns will receive  HIV screening if at risk</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="o">.</span><span class="n">hiv_screening_for_at_risk_newborns</span><span class="p">(</span><span class="n">person_id</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="o">.</span><span class="n">set_death_status</span><span class="p">(</span><span class="n">person_id</span><span class="p">)</span>

        <span class="c1"># Surviving neonates with complications on day 1 are admitted to the inpatient event which lives in the</span>
        <span class="c1"># Postnatal Supervisor module</span>
        <span class="k">if</span> <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">person_id</span><span class="p">,</span> <span class="s1">&#39;nb_early_onset_neonatal_sepsis&#39;</span><span class="p">]</span> <span class="ow">or</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">person_id</span><span class="p">,</span> <span class="s1">&#39;nb_encephalopathy&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;none&#39;</span><span class="p">)</span>\
            <span class="ow">or</span> <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">person_id</span><span class="p">,</span> <span class="s1">&#39;nb_early_preterm&#39;</span><span class="p">]</span> <span class="ow">or</span> <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">person_id</span><span class="p">,</span> <span class="s1">&#39;nb_late_preterm&#39;</span><span class="p">]</span> <span class="ow">or</span>\
           <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">person_id</span><span class="p">,</span> <span class="s1">&#39;nb_kangaroo_mother_care&#39;</span><span class="p">]:</span>

            <span class="n">event</span> <span class="o">=</span> <span class="n">HSI_NewbornOutcomes_NeonatalWardInpatientCare</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span> <span class="n">person_id</span><span class="o">=</span><span class="n">person_id</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="s1">&#39;HealthSystem&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">schedule_hsi_event</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">priority</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">topen</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">date</span><span class="p">,</span> <span class="n">tclose</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></div>

<div class="viewcode-block" id="HSI_NewbornOutcomes_ReceivesPostnatalCheck.never_ran"><a class="viewcode-back" href="../../../reference/tlo.methods.newborn_outcomes.html#tlo.methods.newborn_outcomes.HSI_NewbornOutcomes_ReceivesPostnatalCheck.never_ran">[docs]</a>    <span class="k">def</span> <span class="nf">never_ran</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="o">.</span><span class="n">run_if_care_of_the_receives_postnatal_check_cant_run</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="HSI_NewbornOutcomes_ReceivesPostnatalCheck.did_not_run"><a class="viewcode-back" href="../../../reference/tlo.methods.newborn_outcomes.html#tlo.methods.newborn_outcomes.HSI_NewbornOutcomes_ReceivesPostnatalCheck.did_not_run">[docs]</a>    <span class="k">def</span> <span class="nf">did_not_run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="o">.</span><span class="n">run_if_care_of_the_receives_postnatal_check_cant_run</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="HSI_NewbornOutcomes_ReceivesPostnatalCheck.not_available"><a class="viewcode-back" href="../../../reference/tlo.methods.newborn_outcomes.html#tlo.methods.newborn_outcomes.HSI_NewbornOutcomes_ReceivesPostnatalCheck.not_available">[docs]</a>    <span class="k">def</span> <span class="nf">not_available</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="o">.</span><span class="n">run_if_care_of_the_receives_postnatal_check_cant_run</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="HSI_NewbornOutcomes_NeonatalWardInpatientCare"><a class="viewcode-back" href="../../../reference/tlo.methods.newborn_outcomes.html#tlo.methods.newborn_outcomes.HSI_NewbornOutcomes_NeonatalWardInpatientCare">[docs]</a><span class="k">class</span> <span class="nc">HSI_NewbornOutcomes_NeonatalWardInpatientCare</span><span class="p">(</span><span class="n">HSI_Event</span><span class="p">,</span> <span class="n">IndividualScopeEventMixin</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;This is HSI_PostnatalSupervisor_NeonatalWardInpatientCare. It is scheduled by any of the PNC HSIs for neonates</span>
<span class="sd">    who are require inpatient care due to a complication of the postnatal period. Treatment is delivered in this</span>
<span class="sd">    event&quot;&quot;&quot;</span>

<div class="viewcode-block" id="HSI_NewbornOutcomes_NeonatalWardInpatientCare.__init__"><a class="viewcode-back" href="../../../reference/tlo.methods.newborn_outcomes.html#tlo.methods.newborn_outcomes.HSI_NewbornOutcomes_NeonatalWardInpatientCare.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">person_id</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">person_id</span><span class="o">=</span><span class="n">person_id</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">NewbornOutcomes</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">TREATMENT_ID</span> <span class="o">=</span> <span class="s1">&#39;PostnatalCare_Neonatal_Inpatient&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">EXPECTED_APPT_FOOTPRINT</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_appt_footprint</span><span class="p">({})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ACCEPTED_FACILITY_LEVEL</span> <span class="o">=</span> <span class="s1">&#39;1b&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">BEDDAYS_FOOTPRINT</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_beddays_footprint</span><span class="p">({</span><span class="s1">&#39;general_bed&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">})</span></div>

<div class="viewcode-block" id="HSI_NewbornOutcomes_NeonatalWardInpatientCare.apply"><a class="viewcode-back" href="../../../reference/tlo.methods.newborn_outcomes.html#tlo.methods.newborn_outcomes.HSI_NewbornOutcomes_NeonatalWardInpatientCare.apply">[docs]</a>    <span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">person_id</span><span class="p">,</span> <span class="n">squeeze_factor</span><span class="p">):</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="s1">&#39;message&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="s1">&#39;HSI_PostnatalSupervisor_NeonatalWardInpatientCare now running to capture &#39;</span>
                                         <span class="s1">&#39;inpatient time for an unwell newborn&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="HSI_NewbornOutcomes_NeonatalWardInpatientCare.did_not_run"><a class="viewcode-back" href="../../../reference/tlo.methods.newborn_outcomes.html#tlo.methods.newborn_outcomes.HSI_NewbornOutcomes_NeonatalWardInpatientCare.did_not_run">[docs]</a>    <span class="k">def</span> <span class="nf">did_not_run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="s1">&#39;message&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="s1">&#39;HSI_PostnatalSupervisor_NeonatalWardInpatientCare: did not run&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="HSI_NewbornOutcomes_NeonatalWardInpatientCare.not_available"><a class="viewcode-back" href="../../../reference/tlo.methods.newborn_outcomes.html#tlo.methods.newborn_outcomes.HSI_NewbornOutcomes_NeonatalWardInpatientCare.not_available">[docs]</a>    <span class="k">def</span> <span class="nf">not_available</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="s1">&#39;message&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="s1">&#39;HSI_PostnatalSupervisor_NeonatalWardInpatientCare: cannot not run with &#39;</span>
                                         <span class="s1">&#39;this configuration&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">False</span></div></div>


<div class="viewcode-block" id="BreastfeedingStatusUpdateEventSixMonths"><a class="viewcode-back" href="../../../reference/tlo.methods.newborn_outcomes.html#tlo.methods.newborn_outcomes.BreastfeedingStatusUpdateEventSixMonths">[docs]</a><span class="k">class</span> <span class="nc">BreastfeedingStatusUpdateEventSixMonths</span><span class="p">(</span><span class="n">Event</span><span class="p">,</span> <span class="n">IndividualScopeEventMixin</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; This is BreastfeedingStatusUpdateEventSixMonths. It is scheduled via the breastfeeding function.</span>
<span class="sd">    Children who are alive and still breastfeeding by six months have their breastfeeding status updated. Those who will</span>
<span class="sd">    continue to breastfeed are scheduled BreastfeedingStatusUpdateEventTwoYears</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="BreastfeedingStatusUpdateEventSixMonths.__init__"><a class="viewcode-back" href="../../../reference/tlo.methods.newborn_outcomes.html#tlo.methods.newborn_outcomes.BreastfeedingStatusUpdateEventSixMonths.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">individual_id</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">person_id</span><span class="o">=</span><span class="n">individual_id</span><span class="p">)</span></div>

<div class="viewcode-block" id="BreastfeedingStatusUpdateEventSixMonths.apply"><a class="viewcode-back" href="../../../reference/tlo.methods.newborn_outcomes.html#tlo.methods.newborn_outcomes.BreastfeedingStatusUpdateEventSixMonths.apply">[docs]</a>    <span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">individual_id</span><span class="p">):</span>
        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">population</span><span class="o">.</span><span class="n">props</span>
        <span class="n">child</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">individual_id</span><span class="p">]</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">child</span><span class="o">.</span><span class="n">is_alive</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="c1"># For infants who are exclusively breastfeeding at 6 months, we determine if they will change to non-exclusive</span>
        <span class="c1"># feeding or no breastfeeding</span>
        <span class="k">if</span> <span class="n">child</span><span class="o">.</span><span class="n">nb_breastfeeding_status</span> <span class="o">==</span> <span class="s1">&#39;exclusive&#39;</span><span class="p">:</span>
            <span class="n">random_draw</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="o">.</span><span class="n">rng</span><span class="o">.</span><span class="n">choice</span><span class="p">((</span><span class="s1">&#39;non_exclusive&#39;</span><span class="p">,</span> <span class="s1">&#39;none&#39;</span><span class="p">),</span> <span class="n">p</span><span class="o">=</span><span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">])</span>
            <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">individual_id</span><span class="p">,</span> <span class="s1">&#39;nb_breastfeeding_status&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">random_draw</span>

        <span class="c1"># Similarly, for infants who are non-exclusively breastfeeding at 6 months we determine if they will continue</span>
        <span class="c1"># non-exclusively breastfeeding or stop breastfeeding all together</span>
        <span class="k">if</span> <span class="n">child</span><span class="o">.</span><span class="n">nb_breastfeeding_status</span> <span class="o">==</span> <span class="s1">&#39;non_exclusive&#39;</span><span class="p">:</span>
            <span class="n">random_draw</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="o">.</span><span class="n">rng</span><span class="o">.</span><span class="n">choice</span><span class="p">((</span><span class="s1">&#39;non_exclusive&#39;</span><span class="p">,</span> <span class="s1">&#39;none&#39;</span><span class="p">),</span> <span class="n">p</span><span class="o">=</span><span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">])</span>
            <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">individual_id</span><span class="p">,</span> <span class="s1">&#39;nb_breastfeeding_status&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">random_draw</span>

        <span class="c1"># We then schedule these breastfed newborns to return at 2 years to update breastfeeding status again</span>
        <span class="k">if</span> <span class="n">child</span><span class="o">.</span><span class="n">nb_breastfeeding_status</span> <span class="o">!=</span> <span class="s1">&#39;none&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">schedule_event</span><span class="p">(</span><span class="n">BreastfeedingStatusUpdateEventTwoYears</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span> <span class="n">individual_id</span><span class="p">),</span>
                                    <span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">date</span> <span class="o">+</span> <span class="n">DateOffset</span><span class="p">(</span><span class="n">months</span><span class="o">=</span><span class="mi">18</span><span class="p">))</span></div></div>


<div class="viewcode-block" id="BreastfeedingStatusUpdateEventTwoYears"><a class="viewcode-back" href="../../../reference/tlo.methods.newborn_outcomes.html#tlo.methods.newborn_outcomes.BreastfeedingStatusUpdateEventTwoYears">[docs]</a><span class="k">class</span> <span class="nc">BreastfeedingStatusUpdateEventTwoYears</span><span class="p">(</span><span class="n">Event</span><span class="p">,</span> <span class="n">IndividualScopeEventMixin</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; This is BreastfeedingStatusUpdateEventTwoYears. It is scheduled via the breastfeeding function.</span>
<span class="sd">    Children who are alive and still breastfeeding by two years months have their breastfeeding status updated.&quot;&quot;&quot;</span>

<div class="viewcode-block" id="BreastfeedingStatusUpdateEventTwoYears.__init__"><a class="viewcode-back" href="../../../reference/tlo.methods.newborn_outcomes.html#tlo.methods.newborn_outcomes.BreastfeedingStatusUpdateEventTwoYears.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">individual_id</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">person_id</span><span class="o">=</span><span class="n">individual_id</span><span class="p">)</span></div>

<div class="viewcode-block" id="BreastfeedingStatusUpdateEventTwoYears.apply"><a class="viewcode-back" href="../../../reference/tlo.methods.newborn_outcomes.html#tlo.methods.newborn_outcomes.BreastfeedingStatusUpdateEventTwoYears.apply">[docs]</a>    <span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">individual_id</span><span class="p">):</span>
        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">population</span><span class="o">.</span><span class="n">props</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">individual_id</span><span class="p">,</span> <span class="s1">&#39;is_alive&#39;</span><span class="p">]:</span>
            <span class="k">return</span>

        <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">individual_id</span><span class="p">,</span> <span class="s1">&#39;nb_breastfeeding_status&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span></div></div>
</pre></div>

           </div>
           
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>
      <span class="lastupdated">
        Last updated on May 23, 2022.
      </span>

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>